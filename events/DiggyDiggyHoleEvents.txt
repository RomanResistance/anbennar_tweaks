namespace = diggy

##Event successfull digging
province_event = {
	id = diggy.1
	title = diggy.1.t
	desc = diggy.1.d
	picture = FORT_eventPicture
	goto = root
	
	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	after = {
		hidden_effect = { #Random loc flag
			clr_province_flag = strike_1
			clr_province_flag = strike_2
			clr_province_flag = strike_3
			clr_province_flag = strike_4
			clr_province_flag = strike_5
			clr_province_flag = strike_6
			clr_province_flag = strike_7
			clr_province_flag = strike_8
			clr_province_flag = strike_9
			clr_province_flag = strike_10
			clr_province_flag = strike_11
			clr_province_flag = strike_12
			clr_province_flag = strike_13
			clr_province_flag = strike_14
			clr_province_flag = strike_15
			clr_province_flag = strike_16
			clr_province_flag = strike_17
			clr_province_flag = strike_18
			clr_province_flag = strike_19
			clr_province_flag = strike_20
			
			clr_province_flag = swear_1
			clr_province_flag = swear_2
			clr_province_flag = swear_3
			clr_province_flag = swear_4
			clr_province_flag = swear_5
			clr_province_flag = swear_6
			clr_province_flag = swear_7
			clr_province_flag = swear_8
			clr_province_flag = swear_9
			clr_province_flag = swear_10
			clr_province_flag = swear_11
			clr_province_flag = swear_12
			clr_province_flag = swear_13
			clr_province_flag = swear_14
			clr_province_flag = swear_15
			clr_province_flag = swear_16
			clr_province_flag = swear_17
			clr_province_flag = swear_18
			clr_province_flag = swear_19
			clr_province_flag = swear_20
		}
	}
	
	option = {
        name = diggy.1.a
        ai_chance = { factor = 100 }
		goto = root
		if = {
			limit = { is_capital = yes }
			owner = { add_prestige = 10 }
		}
		else = {
			owner = { add_prestige = 5 }
		}
	}
}

##Event dig production
country_event = {
	id = diggy.2
	title = diggy.2.t
	desc = diggy.2.d
	picture = CITY_DEVELOPMENT_eventPicture
	
	mean_time_to_happen = {
		years = 10
	}
	
	trigger = {
		has_country_flag = is_digging
		NOT = { has_country_flag = dig_prod }
	}
	
	immediate = {
		set_country_flag = dig_prod
	}
	
	option = {
        name = diggy.2.a
        ai_chance = { factor = 100 }
		add_adm_power = -50
		add_country_modifier = {
			name = dig_prod
			duration = -1
		}
		hidden_effect = { capital_scope = { change_variable = { cons_prog = 0.025 } } }
		tooltip = { capital_scope = { change_variable = { cons_prog = 0.05 } } }
	}
	
	option = {
		name = diggy.2.b
		ai_chance = { factor = 100 }
	}
}

##Do Cultural shit while dig
country_event = {
	id = diggy.3
	title = diggy.3.t
	desc = diggy.3.d
	picture = GOLDEN_CITY_eventPicture
	
	mean_time_to_happen = {
		years = 8
	}
	
	trigger = {
		has_country_flag = is_digging
		NOT = { has_country_flag = dig_culture }
		capital_scope = {
			OR = {
				has_terrain = dwarven_hold
				has_terrain = dwarven_hold_surface
			}
		}
	}
	
	immediate = {
		set_country_flag = dig_culture
	}
	
	option = {
        name = diggy.3.a
        ai_chance = { factor = 90 }
		add_adm_power = -80
		add_dip_power = -35
		add_mil_power = -25
		add_prestige = 20
		random = {
			chance = 30
			add_stability_or_adm_power = yes
		}
		hidden_effect = { capital_scope = { change_variable = { cons_prog = -0.025 } } }
		tooltip = { capital_scope = { change_variable = { cons_prog = -0.05 } } }
	}
	
	option = {
		name = diggy.3.b
		ai_chance = { factor = 10 }
		add_prestige = -15
		random = {
			chance = 15
			reduce_stability_or_adm_power = yes
		}
		random = {
			chance = 5
			add_country_modifier = {
				name = dig_not_culture
				duration = 1460
			}
		}
	}
}

##Use the army
country_event = {
	id = diggy.4
	title = diggy.4.t
	desc = diggy.4.d
	picture = CONQUEST__eventPicture
	
	mean_time_to_happen = {
		years = 10
	}
	
	trigger = {
		has_country_flag = is_digging
		NOT = { has_country_flag = dig_manpower }
		capital_scope = {
			OR = {
				has_terrain = dwarven_hold
				has_terrain = dwarven_hold_surface
			}
		}
	}
	
	immediate = {
		set_country_flag = dig_manpower
	}
	
	option = {
        name = diggy.4.a
        ai_chance = { factor = 100 }
		add_mil_power = -50
		add_country_modifier = {
			name = dig_manpower
			duration = -1
		}
		hidden_effect = { capital_scope = { change_variable = { cons_prog = 0.025 } } }
		tooltip = { capital_scope = { change_variable = { cons_prog = 0.05 } } }
	}
	
	option = {
		name = diggy.4.b
		ai_chance = { factor = 100 }
	}
}

### Dig through rock
#Apatite 5Mohs
country_event = {
	id = diggy.5
	title = diggy.5.t
	desc = diggy.5.d
	picture = FORT_eventPicture
	
	mean_time_to_happen = {
		years = 5
	}
	
	trigger = {
		has_country_flag = is_digging
		NOT = { has_country_flag = dig_apatite }
		capital_scope = {
			OR = {
				has_province_modifier = dig_3
				has_province_modifier = dig_4
				has_province_modifier = dig_5
				has_province_modifier = dig_6
				has_province_modifier = dig_7
				has_province_modifier = dig_8
				has_province_modifier = dig_9
			}
		}
	}
	
	immediate = {
		set_country_flag = dig_apatite
	}
	#Dig through
	option = {
        name = diggy.5.a
        ai_chance = { factor = 100 }
		custom_tooltip = dig_through_tooltip
		add_adm_power = -50
		if = {
			limit = { ai = no }
			add_treasury = -350
		}
		hidden_effect = {
			set_country_flag = dig_through
			clr_country_flag = not_dig_through
		}
		hidden_effect = { capital_scope = { change_variable = { cons_prog = 0.075 } } }
		tooltip = { capital_scope = { change_variable = { cons_prog = 0.15 } } }
	}
	#Make detour
	option = {
		name = diggy.5.b
		ai_chance = { factor = 0 }
		custom_tooltip = not_dig_through_tooltip
		add_stability_or_adm_power = yes
		hidden_effect = {
			set_country_flag = not_dig_through
			clr_country_flag = dig_through
		}
		hidden_effect = { capital_scope = { change_variable = { cons_prog = -0.075 } } }
		tooltip = { capital_scope = { change_variable = { cons_prog = -0.15 } } }
	}
}

#orthoclase 6Mohs
country_event = {
	id = diggy.6
	title = diggy.6.t
	desc = diggy.6.d
	picture = FORT_eventPicture
	
	mean_time_to_happen = {
		years = 5
	}
	
	trigger = {
		has_country_flag = is_digging
		has_country_flag = dig_apatite
		NOT = { has_country_flag = dig_ortho }
		capital_scope = {
			OR = {
				has_province_modifier = dig_4
				has_province_modifier = dig_5
				has_province_modifier = dig_6
				has_province_modifier = dig_7
				has_province_modifier = dig_8
				has_province_modifier = dig_9
			}
		}
	}
	
	immediate = {
		set_country_flag = dig_ortho
	}
	#Dig through
	option = {
        name = diggy.6.a
        ai_chance = { factor = 100 }
		custom_tooltip = dig_through_tooltip
		add_adm_power = -50
		if = {
			limit = { ai = no }
			add_treasury = -750
		}
		hidden_effect = {
			set_country_flag = dig_through
			clr_country_flag = not_dig_through
		}
		hidden_effect = { capital_scope = { change_variable = { cons_prog = 0.075 } } }
		tooltip = { capital_scope = { change_variable = { cons_prog = 0.15 } } }
	}
	#Make detour
	option = {
		name = diggy.6.b
		ai_chance = { factor = 0 }
		custom_tooltip = not_dig_through_tooltip
		add_stability_or_adm_power = yes
		hidden_effect = {
			set_country_flag = not_dig_through
			clr_country_flag = dig_through
		}
		hidden_effect = { capital_scope = { change_variable = { cons_prog = -0.075 } } }
		tooltip = { capital_scope = { change_variable = { cons_prog = -0.15 } } }
	}
}

#(iron) Pyrite 6-7Mohs
country_event = {
	id = diggy.7
	title = diggy.7.t
	desc = diggy.7.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		years = 5
	}
	
	trigger = {
		has_country_flag = is_digging
		has_country_flag = dig_ortho
		NOT = { has_country_flag = dig_pyrite }
		capital_scope = {
			OR = {
				has_province_modifier = dig_6
				has_province_modifier = dig_7
				has_province_modifier = dig_8
				has_province_modifier = dig_9
			}
		}
	}
	
	immediate = {
		set_country_flag = dig_pyrite
	}
	#Dig through
	option = {
        name = diggy.7.a
        ai_chance = { factor = 100 }
		custom_tooltip = dig_through_tooltip
		add_adm_power = -50
		if = {
			limit = { ai = no }
			add_treasury = -2250
		}
		hidden_effect = {
			set_country_flag = dig_through
			clr_country_flag = not_dig_through
		}
		hidden_effect = { capital_scope = { change_variable = { cons_prog = 0.075 } } }
		tooltip = { capital_scope = { change_variable = { cons_prog = 0.15 } } }
	}
	#Make detour
	option = {
		name = diggy.7.b
		ai_chance = { factor = 0 }
		custom_tooltip = not_dig_through_tooltip
		add_stability_or_adm_power = yes
		hidden_effect = {
			set_country_flag = not_dig_through
			clr_country_flag = dig_through
		}
		hidden_effect = { capital_scope = { change_variable = { cons_prog = -0.075 } } }
		tooltip = { capital_scope = { change_variable = { cons_prog = -0.15 } } }
	}
}

#Spinel 7.5-8Mohs
country_event = {
	id = diggy.8
	title = diggy.8.t
	desc = diggy.8.d
	picture = FORT_eventPicture
	
	mean_time_to_happen = {
		years = 5
	}
	
	trigger = {
		has_country_flag = is_digging
		has_country_flag = dig_pyrite
		NOT = { has_country_flag = dig_spinel }
		capital_scope = {
			OR = {
				has_province_modifier = dig_7
				has_province_modifier = dig_8
				has_province_modifier = dig_9
			}
		}
	}
	
	immediate = {
		set_country_flag = dig_spinel
	}
	#Dig through
	option = {
        name = diggy.8.a
        ai_chance = { factor = 100 }
		custom_tooltip = dig_through_tooltip
		add_adm_power = -50
		if = {
			limit = { ai = no }
			add_treasury = -3750
		}
		hidden_effect = {
			set_country_flag = dig_through
			clr_country_flag = not_dig_through
		}
		hidden_effect = { capital_scope = { change_variable = { cons_prog = 0.075 } } }
		tooltip = { capital_scope = { change_variable = { cons_prog = 0.15 } } }
	}
	#Make detour
	option = {
		name = diggy.8.b
		ai_chance = { factor = 0 }
		custom_tooltip = not_dig_through_tooltip
		add_stability_or_adm_power = yes
		hidden_effect = {
			set_country_flag = not_dig_through
			clr_country_flag = dig_through
		}
		hidden_effect = { capital_scope = { change_variable = { cons_prog = -0.075 } } }
		tooltip = { capital_scope = { change_variable = { cons_prog = -0.15 } } }
	}
}

#Corundum 9Mohs
country_event = {
	id = diggy.9
	title = diggy.9.t
	desc = diggy.9.d
	picture = FORT_eventPicture
	
	mean_time_to_happen = {
		years = 5
	}
	
	trigger = {
		has_country_flag = is_digging
		has_country_flag = dig_spinel
		NOT = { has_country_flag = dig_corundum }
		capital_scope = {
			OR = {
				has_province_modifier = dig_8
				has_province_modifier = dig_9
			}
		}
	}
	
	immediate = {
		set_country_flag = dig_corundum
	}
	#Dig through
	option = {
        name = diggy.9.a
        ai_chance = { factor = 100 }
		custom_tooltip = dig_through_tooltip
		add_adm_power = -50
		if = {
			limit = { ai = no }
			add_treasury = -5250
		}
		hidden_effect = {
			set_country_flag = dig_through
			clr_country_flag = not_dig_through
		}
		hidden_effect = { capital_scope = { change_variable = { cons_prog = 0.075 } } }
		tooltip = { capital_scope = { change_variable = { cons_prog = 0.15 } } }
	}
	#Make detour
	option = {
		name = diggy.9.b
		ai_chance = { factor = 0 }
		custom_tooltip = not_dig_through_tooltip
		add_stability_or_adm_power = yes
		hidden_effect = {
			set_country_flag = not_dig_through
			clr_country_flag = dig_through
		}
		hidden_effect = { capital_scope = { change_variable = { cons_prog = -0.075 } } }
		tooltip = { capital_scope = { change_variable = { cons_prog = -0.15 } } }
	}
}

#Carbonado 10Mohs
country_event = {
	id = diggy.10
	title = diggy.10.t
	desc = diggy.10.d
	picture = FORT_eventPicture
	
	mean_time_to_happen = {
		years = 5
	}
	
	trigger = {
		has_country_flag = is_digging
		has_country_flag = dig_corundum
		NOT = { has_country_flag = dig_carbonado }
		capital_scope = {
			OR = {
				has_province_modifier = dig_9
				has_province_modifier = dig_10
			}
		}
	}
	
	immediate = {
		set_country_flag = dig_carbonado
	}
	#Dig through
	option = {
        name = diggy.10.a
        ai_chance = { factor = 100 }
		custom_tooltip = dig_through_tooltip
		add_adm_power = -50
		if = {
			limit = { ai = no }
			add_treasury = -5500
		}
		hidden_effect = {
			set_country_flag = dig_through
			clr_country_flag = not_dig_through
		}
		hidden_effect = { capital_scope = { change_variable = { cons_prog = 0.075 } } }
		tooltip = { capital_scope = { change_variable = { cons_prog = 0.15 } } }
	}
	#Make detour
	option = {
		name = diggy.10.b
		ai_chance = { factor = 0 }
		custom_tooltip = not_dig_through_tooltip
		add_stability_or_adm_power = yes
		hidden_effect = {
			set_country_flag = not_dig_through
			clr_country_flag = dig_through
		}
		hidden_effect = { capital_scope = { change_variable = { cons_prog = -0.075 } } }
		tooltip = { capital_scope = { change_variable = { cons_prog = -0.15 } } }
	}
}

#Using explosive
country_event = {
	id = diggy.11
	title = diggy.11.t
	desc = diggy.11.d
	picture = SIERRA_DE_LA_PLATA
	
	mean_time_to_happen = {
		years = 10
	}
	
	trigger = {
		has_country_flag = is_digging
		is_year = 1500
		NOT = { has_country_flag = dig_explosive }
		capital_scope = {
			OR = {
				has_terrain = dwarven_hold
				has_terrain = dwarven_hold_surface
			}
		}
	}
	
	immediate = {
		set_country_flag = dig_explosive
	}
	option = {
        name = diggy.11.a
        ai_chance = { factor = 100 }
		add_adm_power = -35
		add_dip_power = -15
		add_country_modifier = {
			name = dig_explosive
			duration = -1
		}
		hidden_effect = { capital_scope = { change_variable = { cons_prog = 0.05 } } }
		tooltip = { capital_scope = { change_variable = { cons_prog = 0.1 } } }
	}
	
	option = {
		name = diggy.11.b
		ai_chance = { factor = 100 }
	}
}

### Hold Restoration
province_event = {
	id = diggy.12
	title = diggy.12.t
	desc = diggy.12.d
	picture = BUDDHISM_MONASTERY_eventPicture
	goto = root
	
	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	option = {
        name = diggy.12.a
        ai_chance = { factor = 100 }
		goto = ROOT
		if = {
			limit = { is_capital = yes }
			owner = { add_prestige = 5 }
		}
		else = {
			owner = { add_prestige = 2.5 }
		}
		custom_tooltip = hold_restored_tooltip
	}
}

#Capturing a Hold
province_event = {
	id = diggy.13
	title = diggy.13.t
	desc = diggy.13.d
	picture = FEMALE_GENERAL_eventPicture
	goto = root
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_terrain = dwarven_hold
			has_terrain = dwarven_hold_surface
		}
		NOT = { has_province_modifier = ruined_hold }
		NOT = { has_province_modifier = infested_hold }
		NOT = { has_province_modifier = fallen_great_excavation }
		NOT = { ROOT = { owned_by = FROM } }
	}
	
	immediate = {
		remove_province_modifier = hold_being_restored
	}
	
	option = {
        name = diggy.13.a
        ai_chance = { factor = 100 }
		goto = ROOT
		add_devastation = 20
		if = {
			limit = { has_province_modifier = partially_ruined_hold }
			remove_province_modifier = dig_1
			remove_province_modifier = dig_2
			remove_province_modifier = dig_3
			remove_province_modifier = dig_4
			remove_province_modifier = dig_5
			remove_province_modifier = dig_6
			remove_province_modifier = dig_7
			remove_province_modifier = dig_8
			remove_province_modifier = dig_9
			remove_province_modifier = dig_10
			remove_province_modifier = dig_11
			remove_province_modifier = partially_ruined_hold
			add_permanent_province_modifier = {
				name = ruined_hold
				duration = -1
			}
			add_base_production = -3
			add_base_manpower = -3
			add_base_tax = -3
		}
		else_if = {
			limit = { has_province_modifier = damaged_hold }
			remove_province_modifier = damaged_hold
			add_permanent_province_modifier = {
				name = partially_ruined_hold
				duration = -1
			}
			add_base_production = -2
			add_base_manpower = -2
			add_base_tax = -2
		}
		else = {
			add_permanent_province_modifier = {
				name = damaged_hold
				duration = -1
			}
			add_base_production = -1
			add_base_manpower = -1
			add_base_tax = -1
		}
	}
}

###Flavours Events
#Gaz an explosion
country_event = {
	id = diggy.14
	title = diggy.14.t
	desc = diggy.14.d
	picture = VILLAGE_BURNING_eventPicture
	
	mean_time_to_happen = {
		years = 12.5
		
		modifier = {
			factor = 0.5
			NOT = { has_country_modifier = dwarven_administration }
		}
	}
	
	trigger = {
		has_country_modifier = dig_explosive
		has_country_flag = is_digging
		capital_scope = {
			OR = {
				has_terrain = dwarven_hold
				has_terrain = dwarven_hold_surface
			}
		}
	}
	
	option = {
        name = diggy.14.a
        ai_chance = { factor = 100 }
		custom_tooltip = gaz_explosion_tooltip
		capital_scope = {
			add_base_manpower = -1
			add_base_production = -1
			add_base_tax = -1
			random = {
				chance = 50
				
				add_base_manpower = -1
				add_base_production = -1
				add_base_tax = -1
			}
			
			random = {
				chance = 5
				
				add_base_manpower = -1
				add_base_production = -1
				add_base_tax = -1
			}
		}
		hidden_effect = { capital_scope = { change_variable = { cons_prog = -0.1 } } }
		tooltip = { capital_scope = { change_variable = { cons_prog = -0.2 } } }
	}
}
##Lead to Goblin Tide disaster, found treasure
country_event = {
	id = diggy.15
	title = diggy.15.t
	desc = diggy.15.d
	picture = COPTIC_MONASTERY_eventPicture
	
	mean_time_to_happen = {
		years = 70
		
		modifier = {
			factor = 0.9
			
			capital_scope = { has_province_modifier = dig_5 }
		}
		
		modifier = {
			factor = 0.8
			
			capital_scope = { has_province_modifier = dig_6 }
		}
		
		modifier = {
			factor = 0.7
			
			capital_scope = { has_province_modifier = dig_7 }
		}
		
		modifier = {
			factor = 0.6
			
			capital_scope = { has_province_modifier = dig_8 }
		}
		
		modifier = {
			factor = 0.5
			
			capital_scope = { has_province_modifier = dig_9 }
		}
		
		modifier = {
			factor = 0.4
			
			capital_scope = { has_province_modifier = dig_10 }
		}
	}
	
	trigger = {
		has_country_flag = is_digging
		capital_scope = {
			continent = serpentspine
		}
		NOT = { has_country_flag = fallen_treasure }
		capital_scope = {
			OR = {
				has_terrain = dwarven_hold
				has_terrain = dwarven_hold_surface
			}
		}
	}
	
	#Sell it
	option = {
        name = diggy.15.a
        ai_chance = { factor = 50 }
		add_years_of_income = 1
		hidden_effect = {
			random = { chance = 30 set_country_flag = fallen_treasure }
		}
	}
	#Create museum
	option = {
        name = diggy.15.b
        ai_chance = { factor = 30 }
		add_prestige = 30
		hidden_effect = {
			random = { chance = 30 set_country_flag = fallen_treasure }
		}
	}
	#dig deeper in this region
	option = {
        name = diggy.15.c
        ai_chance = { factor = 15 }
		add_years_of_income = 0.5
		add_prestige = 15
		hidden_effect = { set_country_flag = fallen_treasure }
	}
	#Do nothing
	option = {
        name = diggy.15.e
        ai_chance = { factor = 5 }
		increase_legitimacy_small_effect = yes
		add_prestige = -10
	}
}

#Discover old Hold
country_event = {
	id = diggy.16
	title = diggy.16.t
	desc = diggy.16.d
	picture = URBANISATION_INCIDENT_eventPicture
	
	mean_time_to_happen = {
		years = 30
		modifier = {
			factor = 1.5
			
			ai = yes
		}
	}
	
	trigger = {
		has_country_flag = fallen_treasure
		capital_scope = {
			OR = {
				has_terrain = dwarven_hold
				has_terrain = dwarven_hold_surface
			}
		}
		NOT = { capital_scope = { has_province_modifier = old_hold } }
		NOT = { has_country_flag = goblin_tide_happened }
	}
	
	#Such a great discovery, we need to explore it
	option = {
        name = diggy.16.a
        ai_chance = { factor = 90 }
		add_prestige = 50
		increase_legitimacy_medium_effect = yes
		capital_scope = {
			add_permanent_province_modifier = {
				name = old_hold
				duration = -1
			}
		}
	}
	#Seal it, i don't want to hear about it ever again.
	option = {
		name = diggy.16.b
        ai_chance = { factor = 10 }
		highlight = yes
		trigger = { ruler_age = 150 }
		add_prestige = -10
		random = {
			chance = 75
			reduce_stability_or_adm_power = yes
		}
		hidden_effect = { clr_country_flag = fallen_treasure }
	}
}

#Cave Collapse
country_event = {
	id = diggy.17
	title = diggy.17.t
	desc = diggy.17.d
	picture = BANKRUPTCY_eventPicture
	
	mean_time_to_happen = {
		years = 20
		
		modifier = {
			factor = 0.70
			NOT = { has_country_modifier = dwarven_administration }
		}
	}
	
	trigger = {
		has_country_flag = is_digging
		capital_scope = {
			OR = {
				has_terrain = dwarven_hold
				has_terrain = dwarven_hold_surface
			}
		}
	}
	
	option = {
        name = diggy.17.a
        ai_chance = { factor = 90 }
		add_prestige = -5
		capital_scope = {
			random = {
				chance = 50
				add_base_manpower = -1
			}
			random = {
				chance = 50
				add_base_tax = -1
			}
			random = {
				chance = 50
				add_base_production = -1
			}
		}
		hidden_effect = { capital_scope = { change_variable = { cons_prog = -0.05 } } }
		tooltip = { capital_scope = { change_variable = { cons_prog = -0.1 } } }
	}
}
##Easily diggable rock
country_event = {
	id = diggy.18
	title = diggy.18.t
	desc = diggy.18.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		years = 20
	}
	
	trigger = {
		has_country_flag = is_digging
		NOT = { capital_scope = { has_province_modifier = easy_rock } }
		NOT = { capital_scope = { has_province_modifier = hard_rock } }
		capital_scope = {
			OR = {
				has_terrain = dwarven_hold
				has_terrain = dwarven_hold_surface
			}
		}
	}
	
	option = {
        name = diggy.18.a
        ai_chance = { factor = 100 }
		capital_scope = {
			add_province_modifier = {
				name = easy_rock
				duration = 1800
			}
		}
		hidden_effect = { capital_scope = { change_variable = { cons_prog = 0.025 } } }
		tooltip = { capital_scope = { change_variable = { cons_prog = 0.05 } } }
	}
}

##Hard rock to dig
country_event = {
	id = diggy.19
	title = diggy.19.t
	desc = diggy.19.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		years = 30
		
		modifier = {
			factor = 0.5
			NOT = { has_country_modifier = dwarven_administration }
		}
	}
	
	trigger = {
		has_country_flag = is_digging
		NOT = { capital_scope = { has_province_modifier = easy_rock } }
		NOT = { capital_scope = { has_province_modifier = hard_rock } }
		capital_scope = {
			OR = {
				has_terrain = dwarven_hold
				has_terrain = dwarven_hold_surface
			}
		}
	}
	
	option = {
        name = diggy.19.a
        ai_chance = { factor = 100 }
		capital_scope = {
			add_province_modifier = {
				name = hard_rock
				duration = 1800
			}
		}
		hidden_effect = { capital_scope = { change_variable = { cons_prog = -0.025 } } }
		tooltip = { capital_scope = { change_variable = { cons_prog = -0.05 } } }
	}
}

##Discover Damestear
country_event = {
	id = diggy.20
	title = diggy.20.t
	desc = diggy.20.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		years = 300
		modifier = {
			factor = 0.95
			capital_scope = { has_province_modifier = dig_7 }
		}
		modifier = {
			factor = 0.9
			capital_scope = { has_province_modifier = dig_8 }
		}
		modifier = {
			factor = 0.85
			capital_scope = { has_province_modifier = dig_9 }
		}
		modifier = {
			factor = 0.8
			OR = {
				capital_scope = { has_province_modifier = dig_10 }
				capital_scope = { has_province_modifier = dig_11 }
			}
		}
	}
	
	trigger = {
		has_country_flag = is_digging
		capital_scope = {
			OR = {
				has_terrain = dwarven_hold
				has_terrain = dwarven_hold_surface
			}
			NOT = { trade_goods = damestear }
			NOT = { trade_goods = coal }
		}
	}
	
	#Exploit it
	option = {
        name = diggy.20.a
        ai_chance = { factor = 50 }
		add_prestige = 15
		capital_scope = {
			#hidden_effect = { set_province_flag = permanent_damestear } #no perma damestear in the dwarovar
			change_trade_goods = damestear
			if = {
				limit = {
					OR = {
						has_province_modifier = hold_city
						has_province_modifier = hold_artisan
						has_province_modifier = hold_farm
						has_province_modifier = hold_foundry
						has_province_modifier = hold_artisan_2
						has_province_modifier = hold_city_2
						has_province_modifier = hold_farm_2
						has_province_modifier = hold_foundry_2
					}
				}
				remove_province_modifier = hold_city
				remove_province_modifier = hold_artisan
				remove_province_modifier = hold_farm
				remove_province_modifier = hold_foundry
				remove_province_modifier = hold_city_2
				remove_province_modifier = hold_artisan_2
				remove_province_modifier = hold_farm_2
				remove_province_modifier = hold_foundry_2
				hidden_effect = { clr_province_flag = specialized_hold }
			}
			random = {
				chance = 50
				add_permanent_province_modifier = {
					name = huge_damestear
					duration = 12775
				}
			}
		}
	}
	#Leave it
	option = {
        name = diggy.20.b
        ai_chance = { factor = 50 }
		add_prestige = -15
		random = {
			chance = 75
			reduce_stability_or_adm_power = yes
		}
	}
}

##Damestear Explosion
country_event = {
	id = diggy.21
	title = diggy.21.t
	desc = diggy.21.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		years = 150
		modifier = {
			factor = 0.75
			capital_scope = {
				trade_goods = damestear
				has_province_modifier = huge_damestear
			}
		}
		
		modifier = {
			factor = 0.75
			NOT = { has_country_modifier = dwarven_administration }
		}
	}
	
	trigger = {
		has_country_flag = dig_explosive
		capital_scope = { 
			development = 80
			trade_goods = damestear 
			OR = {
				has_terrain = dwarven_hold
				has_terrain = dwarven_hold_surface
			}
		}
	}
	
	#Such horror...
	option = {
        name = diggy.21.a
        ai_chance = { factor = 100 }
		hidden_effect = { clr_country_flag = dig_explosive }
		add_prestige = -10
		reduce_legitimacy_medium_effect = yes
		add_stability = -2
		capital_scope = {
			add_base_manpower = -3
			add_base_tax = -3
			add_base_production = -3
			change_trade_goods = unknown
			if = {
				limit = { has_province_modifier = dig_6 }
				remove_province_modifier = dig_6
				add_permanent_province_modifier = {
					name = dig_5
					duration = -1
				}
			}
			else_if = {
				limit = { has_province_modifier = dig_7 }
				remove_province_modifier = dig_7
				add_permanent_province_modifier = {
					name = dig_6
					duration = -1
				}
			}
			else_if = {
				limit = { has_province_modifier = dig_8 }
				remove_province_modifier = dig_8
				add_permanent_province_modifier = {
					name = dig_7
					duration = -1
				}
			}
			else_if = {
				limit = { has_province_modifier = dig_9 }
				remove_province_modifier = dig_9
				add_permanent_province_modifier = {
					name = dig_8
					duration = -1
				}
			}
			else_if = {
				limit = { has_province_modifier = dig_10 }
				remove_province_modifier = dig_10
				add_permanent_province_modifier = {
					name = dig_9
					duration = -1
				}
			}
			else_if = {
				limit = { has_province_modifier = dig_11 }
				remove_province_modifier = dig_11
				add_permanent_province_modifier = {
					name = dig_10
					duration = -1
				}
			}
		}
		hidden_effect = { capital_scope = { change_variable = { cons_prog = -0.25 } } }
		tooltip = { capital_scope = { change_variable = { cons_prog = -0.5 } } }
	}
}

##Cave Goblin cavern found
country_event = {
	id = diggy.22
	title = diggy.22.t
	desc = diggy.22.d
	picture = ARTWORK_eventPicture
	goto = province
	
	mean_time_to_happen = {
		years = 25
		modifier = {
			factor = 0.9
			capital_scope = { superregion = west_serpentspine_superregion }
		}
		
		modifier = {
			factor = 1.5
			has_country_modifier = remnant_army
		}
	}
	
	immediate = {
		hidden_effect = {
			capital_scope = { save_event_target_as = province }
		}
	}
	
	trigger = {
		has_country_flag = is_digging
		NOT = { culture_group = goblin }
		capital_scope = {  
			OR = {
				has_terrain = dwarven_hold
				has_terrain = dwarven_hold_surface
			}
		}
	}
	
	#Prepare yourself
	option = {
        name = diggy.22.a
        ai_chance = { factor = 100 }
		capital_scope = {
			spawn_rebels = {
				type = cave_goblin_rebel
				culture = cave_goblin
				size = 1.5
			}
		}
	}
}

##Cave Orc cavern found
country_event = {
	id = diggy.23
	title = diggy.23.t
	desc = diggy.23.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		years = 30
		
		modifier = {
			factor = 1.5
			has_country_modifier = remnant_army
		}
	}
	
	trigger = {
		has_country_flag = is_digging
		capital_scope = {  
			OR = {
				has_terrain = dwarven_hold
				has_terrain = dwarven_hold_surface
			}
			superregion = west_serpentspine_superregion
			superregion = east_serpentspine_superregion
		}
	}
	
	#Prepare yourself
	option = {
        name = diggy.23.a
        ai_chance = { factor = 100 }
		capital_scope = {
			spawn_rebels = {
				type = cave_orc_rebel
				culture = black_orc
				size = 1
			}
		}
	}
}

#Beautiful cavern
country_event = {
	id = diggy.24
	title = diggy.24.t
	desc = diggy.24.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		years = 50
		modifier = {
			factor = 0.9
			capital_scope = { superregion = west_serpentspine_superregion }
		}
	}
	
	trigger = {
		has_country_flag = is_digging
		NOT = { capital_scope = { has_province_modifier = beautiful_cave } }
		capital_scope = {
			OR = {
				has_terrain = dwarven_hold
				has_terrain = dwarven_hold_surface
			}
		}
	}
	
	#Sell everything
	option = {
        name = diggy.24.a
        ai_chance = { factor = 10 }
		add_prestige = -5
		reduce_legitimacy_small_effect = yes
		add_years_of_income = 2
	}
	
	#Make it a touristic shit
	option = {
        name = diggy.24.b
        ai_chance = { factor = 90 }
		add_prestige = 5
		capital_scope = {
			add_permanent_province_modifier = {
				name = beautiful_cave
				duration = -1
			}
		}
	}
}

#Cavern benefit
country_event = {
	id = diggy.25
	title = diggy.25.t
	desc = diggy.25.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		years = 10
		modifier = {
			factor = 0.9
			capital_scope = { superregion = west_serpentspine_superregion }
		}
	}
	
	trigger = {
		capital_scope = { has_province_modifier = beautiful_cave }
	}
	
	#Profit
	option = {
        name = diggy.25.a
        ai_chance = { factor = 1 }
		add_prestige = 5
		increase_legitimacy_small_effect = yes
		add_years_of_income = 0.2
	}
	
	#Leader has a genius spark, partially creating fear in the nation
	option = {
        name = diggy.25.b
        ai_chance = { factor = 100 }
		highlight = yes
		trigger = {
			OR = {
				NOT = { adm = 1 }
				NOT = { dip = 1 }
				NOT = { mil = 1 }
			}
			has_regency = no
		}
		custom_tooltip = spark_tooltip
		reduce_legitimacy_huge_effect = yes
		add_stability = -3
		change_adm = 6
		change_mil = 6
		change_dip = 6
	}
}

#Cave collapse
country_event = {
	id = diggy.26
	title = diggy.26.t
	desc = diggy.26.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		years = 50
		
		modifier = {
			factor = 0.5
			NOT = { has_country_modifier = dwarven_administration }
		}
	}
	
	trigger = {
		has_country_flag = is_digging
		capital_scope = { has_province_modifier = beautiful_cave }
		capital_scope = {
			OR = {
				has_terrain = dwarven_hold
				has_terrain = dwarven_hold_surface
			}
		}
	}
	
	#Profit
	option = {
        name = diggy.26.a
        ai_chance = { factor = 100 }
		capital_scope = {
			random = {
				chance = 50
				add_base_manpower = -1
			}
			random = {
				chance = 50
				add_base_tax = -1
			}
			random = {
				chance = 50
				add_base_production = -1
			}
			random = {
				chance = 20
				remove_province_modifier = beautiful_cave
			}
			add_devastation = 15
		}
		random_list = {
			10 = { add_stability = -2 }
			30 = { }
			60 = { reduce_stability_or_adm_power = yes }
		}
		hidden_effect = { capital_scope = { change_variable = { cons_prog = -0.075 } } }
		tooltip = { capital_scope = { change_variable = { cons_prog = -0.15 } } }
	}
}
###Hold Specialization
#Hold Specialization
province_event = {
	id = diggy.27
	title = diggy.27.t
	desc = diggy.27.d
	picture = ARTWORK_eventPicture
	goto = root
	
	mean_time_to_happen = {
		years = 10
	}
	
	trigger = {
		OR = {
			has_terrain = dwarven_hold
			has_terrain = dwarven_hold_surface
		}
		OR = {
			has_province_modifier = dig_4
			has_province_modifier = dig_5
			has_province_modifier = dig_6
			has_province_modifier = dig_7
			has_province_modifier = dig_8
			has_province_modifier = dig_9
			has_province_modifier = dig_10
			has_province_modifier = dig_11
		}
		NOT = { has_province_flag = specialized_hold }
	}
	
	#Foundry
	option = {
        name = diggy.27.a
        ai_chance = { factor = 100 }
		trigger = {
			OR = {
				trade_goods = iron
				trade_goods = damestear
				trade_goods = mithril
				trade_goods = copper
				trade_goods = coal
			}
		}
		goto = ROOT
		add_permanent_province_modifier = {
			name = hold_foundry
			duration = -1
		}
		hidden_effect = { set_province_flag = specialized_hold }
	}
	#city hub
	option = {
        name = diggy.27.b
        ai_chance = { factor = 100 }
		trigger = {
			OR = {
				trade_goods = glass
				trade_goods = cloth
				trade_goods = mithril
				trade_goods = gold
				trade_goods = paper
				trade_goods = wine
				trade_goods = precursor_relics
				trade_goods = gems
				trade_goods = incense
				trade_goods = salt
				base_tax = 30
			}
		}
		goto = ROOT
		add_permanent_province_modifier = {
			name = hold_city
			duration = -1
		}
		hidden_effect = { set_province_flag = specialized_hold }
	}
	#Artisan District
	option = {
        name = diggy.27.c
        ai_chance = { factor = 100 }
		trigger = {
			OR = {
				trade_goods = gems
				trade_goods = wine
				trade_goods = gold
				trade_goods = mithril
				trade_goods = precursor_relics
				trade_goods = incense
			}
		}
		goto = ROOT
		add_permanent_province_modifier = {
			name = hold_artisan
			duration = -1
		}
		hidden_effect = { set_province_flag = specialized_hold }
	}
	#Vertical Farm
	option = {
        name = diggy.27.e
        ai_chance = { factor = 100 }
		trigger = {
			OR = {
				trade_goods = fungi
				trade_goods = livestock
				trade_goods = salt
			}
		}
		goto = ROOT
		add_permanent_province_modifier = {
			name = hold_farm
			duration = -1
		}
		hidden_effect = { set_province_flag = specialized_hold }
	}
	#Military
	option = {
        name = diggy.27.f
        ai_chance = { factor = 100 }
		trigger = {
			OR = {
				trade_goods = iron
				trade_goods = copper
				trade_goods = paper
				trade_goods = mithril
				base_manpower = 25
			}
		}
		goto = ROOT
		add_permanent_province_modifier = {
			name = hold_military
			duration = -1
		}
		hidden_effect = { set_province_flag = specialized_hold }
	}
}

#Orc Warband
country_event = {
	id = diggy.28
	title = diggy.28.t
	desc = diggy.28.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		years = 35
		modifier = {
			factor = 1.5
			has_country_modifier = remnant_army
		}
	}
	
	trigger = {
		NOT = { is_year = 1600 }
		capital_scope = { continent = serpentspine }
		total_development = 100
		any_owned_province = {
			OR = {
				superregion = west_serpentspine_superregion
				superregion = east_serpentspine_superregion
			}
			OR = {
				has_terrain = dwarven_road
				has_terrain = cavern
			}
		}
	}
	
	#Profit
	option = {
        name = diggy.28.a
        ai_chance = { factor = 100 }
		custom_tooltip = orc_warband_tooltip
		hidden_effect = { country_event = { id = diggy.29 days = 150 random = 100 } }
	}
}

country_event = {
	id = diggy.29
	title = diggy.29.t
	desc = diggy.29.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		any_owned_province = {
			has_empty_adjacent_province = yes
			OR = {
				superregion = west_serpentspine_superregion
				superregion = east_serpentspine_superregion
			}
			OR = {
				has_terrain = dwarven_road
				has_terrain = cavern
			}
			any_neighbor_province = { has_terrain = cavern }
		}
	}
	
	option = {
        name = diggy.29.a
        ai_chance = { factor = 100 }
		hidden_effect = {
			random_owned_province = {
				limit = {
					has_empty_adjacent_province = yes
					OR = {
						superregion = west_serpentspine_superregion
						superregion = east_serpentspine_superregion
					}
					OR = {
						has_terrain = dwarven_road
						has_terrain = cavern
					}
					any_neighbor_province = { has_terrain = cavern }
				}
				spawn_rebels = {
					type = cave_orc_rebel
					culture = black_orc
					size = 3
				}
			}
		}
	}
}

#Serpentsmite
country_event = {
	id = diggy.30
	title = diggy.30.t
	desc = diggy.30.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		years = 150
	}
	
	trigger = {
		has_country_flag = is_digging
		capital_scope = {
			OR = {
				has_terrain = dwarven_hold
				has_terrain = dwarven_hold_surface
			}
			NOT = { has_province_flag = serpentsmited }
			continent = serpentspine
		}
	}
	
	immediate = {
		hidden_effect = {
			capital_scope = {
				add_base_manpower = -3
				add_base_tax = -3
				add_base_production = -3
				change_trade_goods = unknown
				if = {
					limit = { has_province_modifier = dig_6 }
					remove_province_modifier = dig_6
					add_permanent_province_modifier = {
						name = dig_5
						duration = -1
					}
				}
				else_if = {
					limit = { has_province_modifier = dig_7 }
					remove_province_modifier = dig_7
					add_permanent_province_modifier = {
						name = dig_6
						duration = -1
					}
				}
				else_if = {
					limit = { has_province_modifier = dig_8 }
					remove_province_modifier = dig_8
					add_permanent_province_modifier = {
						name = dig_7
						duration = -1
					}
				}
				else_if = {
					limit = { has_province_modifier = dig_9 }
					remove_province_modifier = dig_9
					add_permanent_province_modifier = {
						name = dig_8
						duration = -1
					}
				}
				else_if = {
					limit = { has_province_modifier = dig_10 }
					remove_province_modifier = dig_10
					add_permanent_province_modifier = {
						name = dig_9
						duration = -1
					}
				}
				else_if = {
					limit = { has_province_modifier = dig_11 }
					remove_province_modifier = dig_11
					add_permanent_province_modifier = {
						name = dig_10
						duration = -1
					}
				}
				set_province_flag = serpentsmited
			}
		}
	}
	
	#Untaped Ore
	option = {
        name = diggy.30.a
        ai_chance = { factor = 90 }
		reduce_stability_or_adm_power = yes
		capital_scope = {
			random_list = {
				20 = { change_trade_goods = mithril }
				35 = { change_trade_goods = iron }
				45 = { change_trade_goods = copper }
			}
			add_permanent_province_modifier = {
				name = pristine_deposit
				duration = 29200
			}
			remove_province_modifier = hold_city
			remove_province_modifier = hold_artisan
			remove_province_modifier = hold_farm
			remove_province_modifier = hold_military
			remove_province_modifier = hold_foundry
			remove_province_modifier = hold_city_2
			remove_province_modifier = hold_artisan_2
			remove_province_modifier = hold_farm_2
			remove_province_modifier = hold_military_2
			remove_province_modifier = hold_foundry_2
			hidden_effect = { clr_province_flag = specialized_hold }
			hidden_effect = { change_variable = { cons_prog = -0.125 } }
			tooltip = { change_variable = { cons_prog = -0.25 } }
		}
	}
	
	option = {
        name = diggy.30.b
        ai_chance = { factor = 10 }
		add_stability = 2
		capital_scope = {
			hidden_effect = { change_variable = { cons_prog = -0.125 } }
			tooltip = { change_variable = { cons_prog = -0.25 } }
			change_trade_goods = unknown
		}
	}
}

#A Hold develop
province_event = {
	id = diggy.31
	title = diggy.31.t
	desc = diggy.31.d
	picture = ARTWORK_eventPicture
	goto = root
	
	mean_time_to_happen = {
		years = 40
		
		modifier = {
			factor = 0.9
			superregion = west_serpentspine_superregion
		}
		modifier = {
			factor = 0.9
			has_integrated_dwarven_pop_trigger = yes
		}
		modifier = {
			factor = 1.5
			owner = { NOT = { has_country_modifier = dwarven_administration } }
		}
		
		modifier = {
			factor = 1.2
			
			has_province_modifier = orc_hold_arena
		}
		
		modifier = {
			factor = 1.2
			
			has_province_modifier = orc_hold_barrack
		}
		
		modifier = {
			factor = 1.2
			
			has_province_modifier = orc_hold_raider
		}
		
		modifier = {
			factor = 0.8
			owner = { owns = 676 }
			676 = { has_province_modifier = the_harpylen_dam }
		}
		modifier = {
			factor = 0.9
			owner = { tag = I24 } #Aul-Dwarov
		}
		
		modifier = {
			factor = 0.85
			owner = { has_country_modifier = dadv_childrens_of_the_dwarovar }
		}
		
		modifier = {
			factor = 100
			OR = {
				has_integrated_kobold_pop_trigger = yes
				has_integrated_goblin_pop_trigger = yes
			}
			owner = { NOT = { adm_tech = 7 } }
		}
	}
	
	trigger = {
		OR = {
			has_terrain = dwarven_hold
			has_terrain = dwarven_hold_surface
		}
		has_subterranean_race = yes
		is_capital = no
		OR = {
			AND = { development = 40 has_province_modifier = dig_1 }
			AND = { development = 50  has_province_modifier = dig_2 }
			AND = { development = 60  has_province_modifier = dig_3 }
			AND = { development = 70  has_province_modifier = dig_4 }
			AND = { development = 80  has_province_modifier = dig_5 }
			AND = { development = 90  has_province_modifier = dig_6 }
			AND = { development = 100  has_province_modifier = dig_7 }
			AND = { development = 110  has_province_modifier = dig_8 }
			AND = { development = 120  has_province_modifier = dig_9 }
		}
		# owner = { ai = yes }
		owner = { NOT = { has_country_flag = hold_operation } }
	}
	
	#Developing Hold
	option = {
        name = diggy.31.a
        ai_chance = { factor = 100 }
		goto = ROOT
		add_prestige = 10
		if = {
			limit = { has_province_modifier = dig_1 }
			add_permanent_province_modifier = {
				name = dig_2
				duration = -1
			}
			hidden_effect = { remove_province_modifier = dig_1 }
		}
		else_if = {
			limit = { has_province_modifier = dig_2 }
			add_permanent_province_modifier = {
				name = dig_3
				duration = -1
			}
			hidden_effect = { remove_province_modifier = dig_2 }
		}
		else_if = {
			limit = { has_province_modifier = dig_3 }
			add_permanent_province_modifier = {
				name = dig_4
				duration = -1
			}
			hidden_effect = { remove_province_modifier = dig_3 }
		}
		else_if = {
			limit = { has_province_modifier = dig_4 }
			add_permanent_province_modifier = {
				name = dig_5
				duration = -1
			}
			hidden_effect = { remove_province_modifier = dig_4 }
		}
		else_if = {
			limit = { has_province_modifier = dig_5 }
			add_permanent_province_modifier = {
				name = dig_6
				duration = -1
			}
			hidden_effect = { remove_province_modifier = dig_5 }
		}
		else_if = {
			limit = { has_province_modifier = dig_6 }
			add_permanent_province_modifier = {
				name = dig_7
				duration = -1
			}
			hidden_effect = { remove_province_modifier = dig_6 }
		}
		else_if = {
			limit = { has_province_modifier = dig_7 }
			add_permanent_province_modifier = {
				name = dig_8
				duration = -1
			}
			hidden_effect = { remove_province_modifier = dig_7 }
		}
		else_if = {
			limit = { has_province_modifier = dig_8 }
			add_permanent_province_modifier = {
				name = dig_9
				duration = -1
			}
			hidden_effect = { remove_province_modifier = dig_8 }
		}
		else_if = {
			limit = { has_province_modifier = dig_9 }
			add_permanent_province_modifier = {
				name = dig_10
				duration = -1
			}
			hidden_effect = { remove_province_modifier = dig_9 }
		}
	}
}
####Natives attack
province_event = {
	id = diggy.32
	title = diggy.32.t
	desc = diggy.32.d
	picture = ARTWORK_eventPicture
	goto = root
	
	mean_time_to_happen = {
		years = 3
		modifier = {
			factor = 5
			
			ai = yes
		}
		modifier = {
			factor = 1.5
			has_country_modifier = remnant_army
		}
	}
	
	trigger = {
		continent = serpentspine
		is_colony = yes
		NOT = { has_construction = siberian }
		native_size = 10
		
	}
	
	immediate = {
		hidden_effect = {
			create_native = 1
			change_native_size = -5
			random_list = {
				50 = { change_native_hostileness = -1 }
				40 = { change_native_hostileness = -2 }
				10 = { change_native_hostileness = -3 }
			}
			random_list = {
				50 = { change_native_ferocity = -1 }
				40 = { change_native_ferocity = -2 }
				10 = { change_native_ferocity = -3 }
			}
		}
	}
	
	option = {
        name = diggy.32.a
        ai_chance = { factor = 100 }
		goto = ROOT
		custom_tooltip = diggy_native_tooltip
	}
}

####Cavern attack
province_event = {
	id = diggy.33
	title = diggy.33.t
	desc = diggy.33.d
	picture = ARTWORK_eventPicture
	goto = root
	
	mean_time_to_happen = {
		years = 20
		
		modifier = {
			factor = 0.5
			infantry_in_province = 1
		}
		modifier = {
			factor = 1.5
			has_country_modifier = remnant_army
		}
	}
	
	trigger = {
		has_terrain = dwarven_road
		OR = {
			is_colony = yes
			is_city = yes
		}
		any_neighbor_province = {
			native_size = 30
			has_terrain = cavern
			NOT = { is_city = yes }
			NOT = { is_colony = yes }
		}
		NOT = { has_province_modifier = devasted_province }
		owner = { total_development = 100 }
		
	}
	
	option = {
        name = diggy.33.a
        ai_chance = { factor = 100 }
		goto = ROOT
		custom_tooltip = cavern_attack_tooltip
		spawn_rebels = {
			type = cave_goblin_rebel
			culture = cave_goblin
			size = 2
		}
	}
}

###Infested Hold Event
##Infestd Assault
country_event = {
	id = diggy.34
	title = diggy.34.t
	desc = diggy.34.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		years = 2
	}
	
	trigger = {
		total_development = 100
		any_owned_province = {
			has_province_modifier = infested_hold
			OR = {
				superregion = west_serpentspine_superregion
				superregion = east_serpentspine_superregion
			}
			NOT = { has_province_modifier = recent_infested_attack }
			OR = {
				has_orcish_minority_trigger = yes
				has_orcish_majority_trigger = yes
				has_goblin_minority_trigger = yes
				has_goblin_majority_trigger = yes
			}
		}
		NOT = { has_spawned_rebels = cave_goblin_rebel }
		NOT = { has_spawned_rebels = cave_orc_rebel }
	}
	
	#Orc rise up
	option = {
        name = diggy.34.a
        ai_chance = { factor = 100 }
		random_owned_province  = {
			limit = {
				OR = {
					superregion = west_serpentspine_superregion
					superregion = east_serpentspine_superregion
				}
				has_province_modifier = infested_hold
			}
			if = {
				limit = { 
					OR = {
						has_orcish_minority_trigger = yes
						has_orcish_majority_trigger = yes
					}
				}
				if = {
					limit = { development = 3 }
					spawn_rebels = {
						type = cave_orc_rebel
						culture = black_orc
						size = 1
						win = yes
					}
				}
				if = {
					limit = { development = 25 }
					spawn_rebels = {
						type = cave_orc_rebel
						culture = black_orc
						size = 1
						win = yes
					}
				}
			}
			else_if = {
				limit = { 
					OR = {
						has_goblin_minority_trigger = yes
						has_goblin_majority_trigger = yes
					}
				}
				if = {
					limit = { 
						OR = {
							has_goblin_minority_trigger = yes
							has_goblin_majority_trigger = yes
						}
					}
					if = {
						limit = { development = 3 }
						spawn_rebels = {
							type = cave_goblin_rebel
							culture = cave_goblin
							size = 1.5
							win = yes
						}
					}
					if = {
						limit = { development = 15 }
						spawn_rebels = {
							type = cave_goblin_rebel
							culture = cave_goblin
							size = 1.5
							win = yes
						}
					}
					if = {
						limit = { development = 25 }
						spawn_rebels = {
							type = cave_goblin_rebel
							culture = cave_goblin
							size = 1.5
							win = yes
						}
					}
				}
			}
			else = {
				if = {
					limit = { development = 3 }
					spawn_rebels = {
						type = cave_orc_rebel
						culture = black_orc
						size = 1
						win = yes
					}
				}
				if = {
					limit = { development = 25 }
					spawn_rebels = {
						type = cave_orc_rebel
						culture = black_orc
						size = 1
						win = yes
					}
				}
			}
			hidden_effect = {
				add_permanent_province_modifier = {
					name = recent_infested_attack
					duration = 2920
				}
			}
		}
	}
}
##Special Cave Event
country_event = {
	id = diggy.35
	title = diggy.35.t
	desc = diggy.35.d
	picture = CAVE_eventPicture
	
	mean_time_to_happen = {
		months = 12
		
	}
	
	trigger = {
		check_variable = { exploringCave = 1 }
	}
	
	immediate = {
		hidden_effect = {
			subtract_variable = { exploringCave = 1 }
			if = {
				limit = {
					any_owned_province = {
						has_province_modifier = special_cave
						has_province_modifier = exploring_cave
					}
				}
				random_list = {
					5 = { set_country_flag = cave_1 }
					5 = { set_country_flag = cave_2 }
					5 = { set_country_flag = cave_3 }
					5 = { set_country_flag = cave_4 }
					5 = { set_country_flag = cave_5 }
					5 = { set_country_flag = cave_6 }
					5 = { set_country_flag = cave_7 }
					5 = { set_country_flag = cave_8 }
					5 = { set_country_flag = cave_9 }
					5 = { set_country_flag = cave_10 }
					5 = { set_country_flag = cave_11 }
					5 = { set_country_flag = cave_12 }
					5 = { set_country_flag = cave_13 }
					5 = { set_country_flag = cave_14 }
					5 = { set_country_flag = cave_15 }
					5 = { set_country_flag = cave_16 }
					5 = { set_country_flag = cave_17 }
					5 = { set_country_flag = cave_18 }
					5 = { set_country_flag = cave_19 }
					5 = { set_country_flag = cave_20 }
				}
				random_owned_province = {
					limit = { has_province_modifier = exploring_cave is_city = yes }
					save_event_target_as = province
				}
			}
			else = {
				set_country_flag = cave_21 #Clearing exploration flag
			}
		}
	}
	
	option = {
        name = diggy.35.a #Gold Cache
        ai_chance = { factor = 100 }
		trigger = { has_country_flag = cave_1 }
		clr_cavern_exploration = yes
		add_treasury = 150
		random_owned_province = {
			limit = { has_province_modifier = exploring_cave is_city = yes }
			remove_province_modifier = special_cave
			remove_province_modifier = exploring_cave
		}
	}
	
	option = {
        name = diggy.35.b #Old weapon cache
        ai_chance = { factor = 100 }
		trigger = { has_country_flag = cave_2 }
		clr_cavern_exploration = yes
		add_mil_power = 100
		event_target:province = {
			remove_province_modifier = special_cave
			remove_province_modifier = exploring_cave
		}
	}
	
	option = {
        name = diggy.35.c #Huge Mithril Cave
        ai_chance = { factor = 100 }
		trigger = { has_country_flag = cave_3 }
		clr_cavern_exploration = yes
		event_target:province = {
			remove_province_modifier = special_cave
			remove_province_modifier = exploring_cave
			change_trade_goods = mithril
			add_base_manpower = 1
			add_base_production = 3
			add_base_tax = 2
		}
	}
	
	option = {
        name = diggy.35.e #Orc Ambush
        ai_chance = { factor = 100 }
		trigger = { has_country_flag = cave_4 }
		clr_cavern_exploration = yes
		event_target:province = {
			remove_province_modifier = special_cave
			remove_province_modifier = exploring_cave
			spawn_rebels = {
				type = cave_orc_rebel
				culture = black_orc
				size = 1
			}
		}
	}
	
	option = {
        name = diggy.35.f #Old Dwarven Caravan
        ai_chance = { factor = 100 }
		trigger = { has_country_flag = cave_5 }
		clr_cavern_exploration = yes
		event_target:province = {
			remove_province_modifier = special_cave
			remove_province_modifier = exploring_cave
		}
		add_years_of_income = 0.5
	}
	
	option = {
        name = diggy.35.g #Tomb of Gramgir SteelBeard / Old tomb
        ai_chance = { factor = 100 }
		trigger = { has_country_flag = cave_6 }
		clr_cavern_exploration = yes
		event_target:province = {
			remove_province_modifier = special_cave
			remove_province_modifier = exploring_cave
			if = {
				limit = { NOT = { has_global_flag = gramgir_tomb } }
				custom_tooltip = gramgir_tooltip
				add_permanent_province_modifier = {
					name = gramgir_steelbeard
					duration = -1
				}
				hidden_effect = { set_global_flag = gramgir_tomb }
			}
		}
		add_prestige = 10
		add_dip_power = 25
	}
	
	option = {
        name = diggy.35.h #Cave goblin ambush
        ai_chance = { factor = 100 }
		trigger = { has_country_flag = cave_7 }
		clr_cavern_exploration = yes
		event_target:province = {
			remove_province_modifier = special_cave
			remove_province_modifier = exploring_cave
			spawn_rebels = {
				type = cave_goblin_rebel
				culture = cave_goblin
				size = 2
			}
		}
	}
	
	option = {
        name = diggy.35.i #Old Dwarven book Caravan
        ai_chance = { factor = 100 }
		trigger = { has_country_flag = cave_8 }
		clr_cavern_exploration = yes
		event_target:province = {
			remove_province_modifier = special_cave
			remove_province_modifier = exploring_cave
		}
		add_country_modifier = {
			name = old_dwarven_book_caravan
			duration = 7200
		}
	}
	
	option = {
        name = diggy.35.j #Great Dookan temple
        ai_chance = { factor = 100 }
		trigger = { has_country_flag = cave_9 }
		clr_cavern_exploration = yes
		event_target:province = {
			remove_province_modifier = special_cave
			remove_province_modifier = exploring_cave
			add_permanent_province_modifier = {
				name = great_dookan_temple
				duration = -1
			}
		}
		add_prestige = 5
	}
	
	option = {
        name = diggy.35.k #Big Fungi Cave
        ai_chance = { factor = 100 }
		trigger = { has_country_flag = cave_10 }
		clr_cavern_exploration = yes
		event_target:province = {
			remove_province_modifier = special_cave
			remove_province_modifier = exploring_cave
			change_trade_goods = fungi
			add_base_production = 5
			add_base_tax = 2
			add_base_manpower = 1
			add_permanent_province_modifier = {
				name = big_fungi
				duration = -1
			}
		}
	}
	
	option = {
        name = diggy.35.l #Huge Battle Site
        ai_chance = { factor = 100 }
		trigger = { has_country_flag = cave_11 }
		clr_cavern_exploration = yes
		event_target:province = {
			remove_province_modifier = special_cave
			remove_province_modifier = exploring_cave
		}
		add_prestige = 25
		add_mil_power = 50
	}
	
	option = {
        name = diggy.35.m #All for nothing
        ai_chance = { factor = 100 }
		trigger = { has_country_flag = cave_12 }
		clr_cavern_exploration = yes
		event_target:province = {
			remove_province_modifier = special_cave
			remove_province_modifier = exploring_cave
		}
		add_prestige = -5
		add_treasury = -75
	}
	
	option = {
        name = diggy.35.n #A deep hole
        ai_chance = { factor = 100 }
		trigger = { has_country_flag = cave_13 }
		clr_cavern_exploration = yes
		event_target:province = {
			remove_province_modifier = special_cave
			remove_province_modifier = exploring_cave
		}
		add_prestige = 5
	}
	
	option = {
        name = diggy.35.o #How to dig book
        ai_chance = { factor = 100 }
		trigger = { has_country_flag = cave_14 }
		clr_cavern_exploration = yes
		event_target:province = {
			remove_province_modifier = special_cave
			remove_province_modifier = exploring_cave
		}
		if = {
			limit = { NOT = { has_country_modifier = how_to_dig } }
			custom_tooltip = how_to_dig_tooltip
			add_country_modifier = {
				name = how_to_dig
				duration = 43800
			}
		}
		add_prestige = 5
	}
	
	option = {
        name = diggy.35.p #Killing an Orc book
        ai_chance = { factor = 100 }
		trigger = { has_country_flag = cave_15 }
		clr_cavern_exploration = yes
		event_target:province = {
			remove_province_modifier = special_cave
			remove_province_modifier = exploring_cave
		}
		add_country_modifier = {
			name = kiling_an_orc
			duration = 43800
		}
		add_prestige = 5
	}
	
	option = {
        name = diggy.35.q #Monstruous cache of gold
        ai_chance = { factor = 100 }
		trigger = { has_country_flag = cave_16 }
		clr_cavern_exploration = yes
		event_target:province = {
			remove_province_modifier = special_cave
			remove_province_modifier = exploring_cave
		}
		add_years_of_income = 1
	}
	
	option = {
        name = diggy.35.r #Sink hole destroy exploring party
        ai_chance = { factor = 100 }
		trigger = { has_country_flag = cave_17 }
		clr_cavern_exploration = yes
		event_target:province = {
			remove_province_modifier = special_cave
			remove_province_modifier = exploring_cave
		}
		reduce_stability_or_adm_power = yes
	}
	
	option = {
        name = diggy.35.s #Old orcish artefact
        ai_chance = { factor = 100 }
		trigger = { has_country_flag = cave_18 }
		clr_cavern_exploration = yes
		event_target:province = {
			remove_province_modifier = special_cave
			remove_province_modifier = exploring_cave
		}
		add_stability_or_adm_power = yes
	}
	
	option = {
        name = diggy.35.ta #Gnipahellir / Beautiful cavern
        ai_chance = { factor = 100 }
		trigger = { has_country_flag = cave_19 }
		clr_cavern_exploration = yes
		event_target:province = {
			remove_province_modifier = special_cave
			remove_province_modifier = exploring_cave
			if = {
				limit = { NOT = { has_global_flag = gnipahellir } }
				custom_tooltip = gnipahellir_cavern_tooltip
				add_permanent_province_modifier = {
					name = gnipahellir_cavern
					duration = -1
				}
				add_base_tax = 5
				add_base_manpower = 5
				hidden_effect = { set_global_flag = gnipahellir }
			}
		}
		add_stability_or_adm_power = yes
	}
	
	option = {
        name = diggy.35.u #Hehodovar Codex / Old Dwarven artefact
        ai_chance = { factor = 100 }
		trigger = { has_country_flag = cave_20 }
		clr_cavern_exploration = yes
		event_target:province = {
			remove_province_modifier = special_cave
			remove_province_modifier = exploring_cave
		}
		if = {
			limit = { NOT = { has_global_flag = hehodovar_codex } }
			custom_tooltip = hehodovar_codex_tooltip
			add_country_modifier = {
				name = hehodovar_codex
				duration = -1
			}
			hidden_effect = { set_global_flag = hehodovar_codex }
		}
		add_prestige = 20
		random = {
			chance = 50
			add_stability_or_adm_power = yes
		}
	}
	
	option = {
		name = diggy.35.v #Clear exploration flag for performance
		ai_chance = { factor = 100 }
		trigger = { has_country_flag = cave_21 }
		clr_cavern_exploration = yes
		hidden_effect = {
			clr_country_flag = cavern_ini
			every_owned_province = { #Avoid locked cavern
				remove_province_modifier = exploring_cave
			}
		}
	}
}

##Restoring a Rail
province_event = {
	id = diggy.36
	title = diggy.36.t
	desc = diggy.36.d
	picture = ARTWORK_eventPicture
	goto = root
	
	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	option = {
        name = diggy.36.a
        ai_chance = { factor = 100 }
		goto = ROOT
		owner = { add_prestige = 1 }
	}
}

##Discovery of an incredible cave
province_event = {
	id = diggy.37
	title = diggy.37.t
	desc = diggy.37.d
	picture = ARTWORK_eventPicture
	goto = root
	
	fire_only_once = yes
	mean_time_to_happen = {
		years = 15
	}
	
	trigger = {
		has_province_modifier = beautiful_cave
		continent = serpentspine
		NOT = { has_global_flag = serpent_rot }
		is_year = 1650
	}
	
	immediate = {
		hidden_effect = { set_global_flag = serpent_rot }
	}
	
	option = {
        name = diggy.37.a
        ai_chance = { factor = 100 }
		goto = ROOT
		add_permanent_province_modifier = {
			name = mycos_caurak
			duration = -1
		}
		hidden_effect = {
			country_event = { id = diggy.38 days = 100 random = 50 }
		}
	}
}

##Propose exploration of the lake
country_event = {
	id = diggy.38
	title = diggy.38.t
	desc = diggy.38.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		years = 10
	}
	
	trigger = {
		capital_scope = { continent = serpentspine }
		any_owned_province = {
			has_province_modifier = mycos_caurak
		}
		NOT = { has_country_flag = mycos_flag }
	}
	
	immediate = {
		hidden_effect = { set_country_flag = mycos_flag }
	}
	
	### Yes
	option = {
        name = diggy.38.a
        ai_chance = { factor = 100 }
		add_years_of_income = -0.1
		add_adm_power = -20
		add_dip_power = -20
		hidden_effect = { 
			country_event = { id = diggy.39 days = 500 random = 100 }
			set_country_flag = sent_expedition
		}
	}
	
	### No, we want to let this pristine cave be pristine
	option = {
        name = diggy.38.b
        ai_chance = { factor = 100 }
		hidden_effect = { country_event = { id = diggy.39 days = 1000 random = 100 } }
	}
}
##Discover the beast + cave collapse
country_event = {
	id = diggy.39
	title = diggy.39.t
	desc = {
		trigger = { has_country_flag = sent_expedition }
		desc = diggy.39.d.1
	}
	desc = {
		trigger = { NOT = { has_country_flag = sent_expedition } }
		desc = diggy.39.d.2
	}
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		any_owned_province = {
			has_province_modifier = mycos_caurak
		}
	}
	
	### Contain the collapse
	option = {
        name = diggy.39.a
        ai_chance = { factor = 100 }
		add_years_of_income = -0.05
		add_adm_power = -10
		add_dip_power = -10
		add_mil_power = -10
		random_owned_province = {
			limit = { has_province_modifier = mycos_caurak }
			remove_province_modifier = mycos_caurak
			hidden_effect = { set_province_flag = caurak_collapse }
		}
		hidden_effect = { set_country_flag = serpent_rot_start clr_country_flag = sent_expedition }
	}
}

##The Remnant Awekening
country_event = {
	id = diggy.40
	title = diggy.40.t
	desc = diggy.40.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		has_country_modifier = remnant_legacy
		NOT = { has_country_flag = remnant_legacy }
	}
	
	# Call digging expert
	option = {
        name = diggy.40.a
        ai_chance = { factor = 10 }
		add_adm_power = -250
		hidden_effect = { set_country_flag = remnant_legacy }
		hidden_effect = { set_country_flag = remnant_dig }
		hidden_effect = { country_event = { id = diggy.41 days = 2555 random = 3650 } }
		
		custom_tooltip = remnant_awakening_tooltip
	}
	# Establish expansion plans
	option = {
        name = diggy.40.b
        ai_chance = { factor = 80 }
		add_dip_power = -250
		hidden_effect = { set_country_flag = remnant_legacy }
		hidden_effect = { set_country_flag = remnant_colonial }
		hidden_effect = { country_event = { id = diggy.41 days = 2555 random = 3650 } }
		
		custom_tooltip = remnant_awakening_tooltip
	}
	# Revive old foundry
	option = {
        name = diggy.40.c
        ai_chance = { factor = 10 }
		add_mil_power = -250
		hidden_effect = { set_country_flag = remnant_legacy }
		hidden_effect = { set_country_flag = remnant_army }
		hidden_effect = { country_event = { id = diggy.41 days = 2555 random = 3650 } }
		
		custom_tooltip = remnant_awakening_tooltip
	}
}

country_event = {
	id = diggy.41
	title = diggy.41.t
	desc = diggy.41.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		has_country_modifier = remnant_legacy
		has_country_flag = remnant_legacy
	}
	
	immediate = {
		#This is absolutely disgusting but it's the only way to discover all adjacent provinces 3 out
		hidden_effect = {
			capital_scope = {
				every_neighbor_province = {
				discover_country = ROOT
					every_neighbor_province = {
					discover_country = ROOT
						every_neighbor_province = {
							discover_country = ROOT
						}
						every_empty_neighbor_province = {
							discover_country = ROOT
						}
					}
					every_empty_neighbor_province = {
					discover_country = ROOT
						every_neighbor_province = {
							discover_country = ROOT
						}
						every_empty_neighbor_province = {
							discover_country = ROOT
						}
					}
				}
				every_empty_neighbor_province = {
				discover_country = ROOT
					every_neighbor_province = {
					discover_country = ROOT
						every_neighbor_province = {
							discover_country = ROOT
						}
						every_empty_neighbor_province = {
							discover_country = ROOT
						}
					}
					every_empty_neighbor_province = {
					discover_country = ROOT
						every_neighbor_province = {
							discover_country = ROOT
						}
						every_empty_neighbor_province = {
							discover_country = ROOT
						}
					}
				}
			}
		}
	}
	
	# Call digging expert
	option = {
        name = diggy.41.a
        ai_chance = { factor = 10 }
		trigger = { has_country_flag = remnant_dig }
		add_prestige = 10
		remove_country_modifier = remnant_legacy
		add_country_modifier = {
			name = remnant_dig
			duration = 18250
		}
		hidden_effect = { clr_country_flag = remnant_legacy }
		hidden_effect = { clr_country_flag = remnant_dig }
		if = {
			limit = { capital_scope = { has_province_modifier = dig_1 } }
			capital_scope = {
				add_permanent_province_modifier = {
					name = dig_2
					duration = -1
				}
				hidden_effect = { remove_province_modifier = dig_1 }
			}
		}
		else_if = {
			limit = { capital_scope = { has_province_modifier = dig_2 } }
			capital_scope = {
				add_permanent_province_modifier = {
					name = dig_3
					duration = -1
				}
				hidden_effect = { remove_province_modifier = dig_2 }
			}
		}
		else_if = {
			limit = { capital_scope = { has_province_modifier = dig_3 } }
			capital_scope = {
				add_permanent_province_modifier = {
					name = dig_4
					duration = -1
				}
				hidden_effect = { remove_province_modifier = dig_3 }
			}
		}
		else_if = {
			limit = { capital_scope = { has_province_modifier = dig_4 } }
			capital_scope = {
				add_permanent_province_modifier = {
					name = dig_5
					duration = -1
				}
				hidden_effect = { remove_province_modifier = dig_4 }
			}
		}
		else_if = {
			limit = { capital_scope = { has_province_modifier = dig_5 } }
			capital_scope = {
				add_permanent_province_modifier = {
					name = dig_6
					duration = -1
				}
				hidden_effect = { remove_province_modifier = dig_5 }
			}
		}
		else_if = {
			limit = { capital_scope = { has_province_modifier = dig_6 } }
			capital_scope = {
				add_permanent_province_modifier = {
					name = dig_7
					duration = -1
				}
				hidden_effect = { remove_province_modifier = dig_6 }
			}
		}
		else_if = {
			limit = { capital_scope = { has_province_modifier = dig_7 } }
			capital_scope = {
				add_permanent_province_modifier = {
					name = dig_8
					duration = -1
				}
				hidden_effect = { remove_province_modifier = dig_7 }
			}
		}
		else_if = {
			limit = { capital_scope = { has_province_modifier = dig_8 } }
			capital_scope = {
				add_permanent_province_modifier = {
					name = dig_9
					duration = -1
				}
				hidden_effect = { remove_province_modifier = dig_8 }
			}
		}
		else_if = {
			limit = { capital_scope = { has_province_modifier = dig_9 } }
			capital_scope = {
				add_permanent_province_modifier = {
					name = dig_10
					duration = -1
				}
				hidden_effect = { remove_province_modifier = dig_9 }
			}
		}
	}
	# Establish expansion plans
	option = {
        name = diggy.41.b
        ai_chance = { factor = 80 }
		trigger = { has_country_flag = remnant_colonial }
		add_prestige = 10
		remove_country_modifier = remnant_legacy
		#remove_country_modifier = inward_military
		add_country_modifier = {
			name = remnant_colonial
			duration = 18250
		}
		hidden_effect = { clr_country_flag = remnant_legacy }
		hidden_effect = { clr_country_flag = remnant_colonial }
		
	}
	# Revive old foundry
	option = {
        name = diggy.41.c
        ai_chance = { factor = 10 }
		trigger = { has_country_flag = remnant_army }
		add_prestige = 10
		#remove_country_modifier = inward_military
		remove_country_modifier = remnant_legacy
		add_country_modifier = {
			name = remnant_army
			duration = 18250
		}
		hidden_effect = { clr_country_flag = remnant_legacy }
		hidden_effect = { clr_country_flag = remnant_army }
	}
}

##Upgrading a Rail
province_event = {
	id = diggy.42
	title = diggy.42.t
	desc = diggy.42.d
	picture = ARTWORK_eventPicture
	goto = root
	
	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	option = {
        name = diggy.42.a
        ai_chance = { factor = 100 }
		goto = ROOT
		owner = { add_prestige = 2 }
	}
}

##Irrigation system
country_event = {
	id = diggy.43
	title = diggy.43.t
	desc = diggy.43.d
	picture = FARMING_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	
	#North
	option = {
        name = diggy.43.a
        ai_chance = { factor = 100 }
		trigger = { NOT = { has_global_flag = irrigation_north } }
		hidden_effect = { set_global_flag = irrigation_north }
		hidden_effect = { country_event = { id = diggy.44 days = 1825 random = 365 } }
		if = {
			limit = { ai = no }
			add_treasury = -1500
			add_adm_power = -200
		}
		else = {
			add_treasury = -500
		}
	}
	#South
	option = {
        name = diggy.43.b
        ai_chance = { factor = 100 }
		trigger = { NOT = { has_global_flag = irrigation_south } }
		hidden_effect = { set_global_flag = irrigation_south }
		hidden_effect = { country_event = { id = diggy.44 days = 1825 random = 365 } }
		if = {
			limit = { ai = no }
			add_treasury = -1500
			add_adm_power = -200
		}
		else = {
			add_treasury = -500
		}
	}
	#East
	option = {
        name = diggy.43.c
        ai_chance = { factor = 100 }
		trigger = { NOT = { has_global_flag = irrigation_east } }
		hidden_effect = { set_global_flag = irrigation_east }
		hidden_effect = { country_event = { id = diggy.44 days = 1825 random = 365 } }
		if = {
			limit = { ai = no }
			add_treasury = -1500
			add_adm_power = -200
		}
		else = {
			add_treasury = -500
		}
	}
	#West
	option = {
        name = diggy.43.e
        ai_chance = { factor = 100 }
		trigger = { NOT = { has_global_flag = irrigation_west } }
		hidden_effect = { set_global_flag = irrigation_west }
		hidden_effect = { country_event = { id = diggy.44 days = 1825 random = 365 } }
		if = {
			limit = { ai = no }
			add_treasury = -1500
			add_adm_power = -200
		}
		else = {
			add_treasury = -500
		}
	}
	#GoBack
	option = {
        name = diggy.43.f
        ai_chance = { factor = 0 }
		hidden_effect = { clr_country_flag = repairing_irrigation }
	}
}

country_event = {
	id = diggy.44
	title = diggy.44.t
	desc = diggy.44.d
	picture = FARMING_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
		hidden_effect = { clr_country_flag = repairing_irrigation }
	}
	
	option = {
        name = diggy.44.a
        ai_chance = { factor = 100 }
		if = {
			limit = { 
				has_global_flag = irrigation_north
				NOT = { has_global_flag = irrigation_north_done }
			}
			castle_hill_area = {
				if = {
					limit = { NOT = { province_id = 4120 } }
					add_base_manpower = 1
					add_base_tax = 1
					add_base_production = 1
					remove_province_modifier = flooded_province
					add_province_triggered_modifier = efficient_irrigation
					change_trade_goods = grain
				}
			}
			hidden_effect = { set_global_flag = irrigation_north_done }
		}
		else_if = {
			limit = { 
				has_global_flag = irrigation_south
				NOT = { has_global_flag = irrigation_south_done }
			}
			royal_terrace_area = {
				if = {
					limit = { NOT = { province_id = 4121 } }
					add_base_manpower = 1
					add_base_tax = 1
					add_base_production = 1
					remove_province_modifier = flooded_province
					add_province_triggered_modifier = efficient_irrigation
					change_trade_goods = grain
				}
			}
			hidden_effect = { set_global_flag = irrigation_south_done }
		}
		else_if = {
			limit = { 
				has_global_flag = irrigation_west
				NOT = { has_global_flag = irrigation_west_done }
			}
			assembly_terrace_area = {
				add_base_manpower = 1
				add_base_tax = 1
				add_base_production = 1
				remove_province_modifier = flooded_province
				add_province_triggered_modifier = efficient_irrigation
				change_trade_goods = grain
			}
			hidden_effect = { set_global_flag = irrigation_west_done }
		}
		else_if = {
			limit = { 
				has_global_flag = irrigation_east
				NOT = { has_global_flag = irrigation_east_done }
			}
			common_terrace_area = {
				add_base_manpower = 1
				add_base_tax = 1
				add_base_production = 1
				remove_province_modifier = flooded_province
				add_province_triggered_modifier = efficient_irrigation
				change_trade_goods = grain
			}
			hidden_effect = { set_global_flag = irrigation_east_done }
		}
	}
}

#Irrigation done, gain cool modifier
country_event = {
	id = diggy.45
	title = diggy.45.t
	desc = diggy.45.d
	picture = FARMING_eventPicture
	
	fire_only_once = yes
	
	mean_time_to_happen = {
		months = 1
	}
	
	trigger = {
		4119 = {
			owned_by = ROOT
		}
		irrigation_dwarovar = {
			type = all
			country_or_vassal_holds = ROOT
			has_province_modifier = efficient_irrigation
		}
	}
	
	option = {
        name = diggy.45.a
        ai_chance = { factor = 100 }
		hidden_effect = {
			set_global_flag = serpent_vale_irrigation
			clr_global_flag = irrigation_east
			clr_global_flag = irrigation_north
			clr_global_flag = irrigation_west
			clr_global_flag = irrigation_south
			clr_global_flag = irrigation_east_done
			clr_global_flag = irrigation_north_done
			clr_global_flag = irrigation_west_done
			clr_global_flag = irrigation_south_done
		}
		4119 = {
			add_permanent_province_modifier = {
				name = dwarovar_granary
				duration = -1
			}
		}
	}
}

#Convert non-ancestor worship dwarves
country_event = {
	id = diggy.46
	title = diggy.46.t
	desc = diggy.46.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		years = 1
	}
	
	trigger = {
		has_country_modifier = dwarven_administration
		NOT = { religion = ancestor_worship }
		is_subject = no
		capital_scope = {
			continent = serpentspine
			OR = {
				has_terrain = dwarven_hold
				has_terrain = dwarven_hold_surface
			}
		}
		NOT = { has_country_flag = diggy_proposed_conversion }
		NOT = { tag = H94 } #Obsidian Invasion
		NOT = { tag = I23 } #Haraz Dhumankon
	}
	
	immediate = {
		hidden_effect = { set_country_flag = diggy_proposed_conversion }
	}
	
	option = {
        name = diggy.46.a
        ai_chance = { factor = 5 }
		add_prestige = -5
		increase_legitimacy_small_effect = yes
	}
	
	option = {
        name = diggy.46.b
        ai_chance = { 
			factor = 95
			modifier = {
				factor = 0
				OR = {
					tag = Z36
					tag = B18
				}
			}
		}
		add_prestige = 5
		every_owned_province = { change_religion = ancestor_worship }
		change_religion = ancestor_worship
		hidden_effect = {
			add_prestige = 100
		}
	}
}

#Dynamically restoring a hold
country_event = {
	id = diggy.47
	title = diggy.47.t
	desc = diggy.47.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
		hidden_effect = {
			define_hold_to_repair = yes
		}
	}
	
	after = {
		hidden_effect = {
			every_owned_province = {
				limit = { has_province_flag = repair_@ROOT }
				clr_province_flag = repair_@ROOT
				clr_province_flag = option_repair_1_@ROOT
				clr_province_flag = option_repair_2_@ROOT
				clr_province_flag = option_repair_3_@ROOT
				clr_province_flag = option_repair_4_@ROOT
				clr_province_flag = option_repair_5_@ROOT
				clr_province_flag = option_repair_6_@ROOT
			}
			clr_country_flag = open_repair_hold_menu
		}
	}
	
	option = {
        name = diggy.47.a
        ai_chance = { factor = 5 }
		trigger = { any_owned_province = { has_province_flag = option_repair_1_@ROOT } }
		goto = repair1
		event_target:repair1 = {
			repair_hold = yes
		}
	}
	
	option = {
        name = diggy.47.b
        ai_chance = { factor = 5 }
		trigger = { any_owned_province = { has_province_flag = option_repair_2_@ROOT } }
		goto = repair2
		event_target:repair2 = {
			repair_hold = yes
		}
	}
	
	option = {
        name = diggy.47.c
        ai_chance = { factor = 5 }
		trigger = { any_owned_province = { has_province_flag = option_repair_3_@ROOT } }
		goto = repair3
		event_target:repair3 = {
			repair_hold = yes
		}
	}
	
	option = {
        name = diggy.47.e
        ai_chance = { factor = 5 }
		trigger = { any_owned_province = { has_province_flag = option_repair_4_@ROOT } }
		goto = repair4
		event_target:repair4 = {
			repair_hold = yes
		}
	}
	
	option = {
        name = diggy.47.f
        ai_chance = { factor = 5 }
		trigger = { any_owned_province = { has_province_flag = option_repair_5_@ROOT } }
		goto = repair5
		event_target:repair5 = {
			repair_hold = yes
		}
	}
	
	option = {
        name = diggy.47.g
        ai_chance = { factor = 5 }
		trigger = { any_owned_province = { has_province_flag = option_repair_6_@ROOT } }
		goto = repair6
		event_target:repair6 = {
			repair_hold = yes
		}
	}
	#Go Back
	option = {
        name = diggy.47.h
        ai_chance = { factor = 0 }
	}
}

#Dynamically clear a hold
country_event = {
	id = diggy.48
	title = diggy.48.t
	desc = diggy.48.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
		hidden_effect = {
			define_hold_to_clear = yes
		}
	}
	
	after = {
		clr_country_flag = open_infested_hold_menu
	}
	
	option = {
        name = diggy.48.a
        ai_chance = { factor = 5 }
		trigger = { any_owned_province = { has_province_flag = option_infested_1_@ROOT is_city = yes } }
		goto = infested1
		random_owned_province = {
			limit = { has_province_flag = option_infested_1_@ROOT is_city = yes }
			infested_hold_clearing = yes
		}
	}
	
	option = {
        name = diggy.48.b
        ai_chance = { factor = 5 }
		trigger = { any_owned_province = { has_province_flag = option_infested_2_@ROOT is_city = yes } }
		goto = infested2
		random_owned_province = {
			limit = { has_province_flag = option_infested_2_@ROOT is_city = yes }
			infested_hold_clearing = yes
		}
	}
	
	option = {
        name = diggy.48.c
        ai_chance = { factor = 5 }
		trigger = { any_owned_province = { has_province_flag = option_infested_3_@ROOT is_city = yes } }
		goto = infested3
		random_owned_province = {
			limit = { has_province_flag = option_infested_3_@ROOT is_city = yes }
			infested_hold_clearing = yes
		}
	}
	
	option = {
        name = diggy.48.e
        ai_chance = { factor = 5 }
		trigger = { any_owned_province = { has_province_flag = option_infested_4_@ROOT is_city = yes } }
		goto = infested4
		random_owned_province = {
			limit = { has_province_flag = option_infested_4_@ROOT is_city = yes }
			infested_hold_clearing = yes
		}
	}
	
	#Go Back
	option = {
        name = diggy.48.f
        ai_chance = { factor = 0 }
		hidden_effect = {
			every_owned_province = {
				limit = { has_province_flag = infested_@ROOT }
				clr_province_flag = infested_@ROOT
				clr_province_flag = option_infested_1_@ROOT
				clr_province_flag = option_infested_2_@ROOT
				clr_province_flag = option_infested_3_@ROOT
				clr_province_flag = option_infested_4_@ROOT
			}
			clr_country_flag = open_infested_hold_menu
		}
	}
}


#Hold digging menu
country_event = {
	id = diggy.49
	title = diggy.49.t
	desc = diggy.49.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
		hidden_effect = { define_hold_that_can_dig = yes }
	}
	
	#Hold
	option = {
        name = diggy.49.1
        ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_1_@ROOT } }
		goto = hold1
		random_owned_province = {
			limit = { has_province_flag = option_hold_1_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
        name = diggy.49.2
        ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_2_@ROOT } }
		goto = hold2
		random_owned_province = {
			limit = { has_province_flag = option_hold_2_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
        name = diggy.49.3
        ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_3_@ROOT } }
		goto = hold3
		random_owned_province = {
			limit = { has_province_flag = option_hold_3_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
        name = diggy.49.4
        ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_4_@ROOT } }
		goto = hold4
		random_owned_province = {
			limit = { has_province_flag = option_hold_4_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
        name = diggy.49.5
        ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_5_@ROOT } }
		goto = hold5
		random_owned_province = {
			limit = { has_province_flag = option_hold_5_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
        name = diggy.49.6
        ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_6_@ROOT } }
		goto = hold6
		random_owned_province = {
			limit = { has_province_flag = option_hold_6_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
        name = diggy.49.7
        ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_7_@ROOT } }
		goto = hold7
		random_owned_province = {
			limit = { has_province_flag = option_hold_7_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
        name = diggy.49.8
        ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_8_@ROOT } }
		goto = hold8
		random_owned_province = {
			limit = { has_province_flag = option_hold_8_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
        name = diggy.49.9
        ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_9_@ROOT } }
		goto = hold9
		random_owned_province = {
			limit = { has_province_flag = option_hold_9_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
        name = diggy.49.10
        ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_10_@ROOT } }
		goto = hold10
		random_owned_province = {
			limit = { has_province_flag = option_hold_10_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
        name = diggy.49.11
        ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_11_@ROOT } }
		goto = hold11
		random_owned_province = {
			limit = { has_province_flag = option_hold_11_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
		name = diggy.49.12
		ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_12_@ROOT } }
		goto = hold12
		random_owned_province = {
			limit = { has_province_flag = option_hold_12_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
		name = diggy.49.13
		ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_13_@ROOT } }
		goto = hold13
		random_owned_province = {
			limit = { has_province_flag = option_hold_13_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
		name = diggy.49.14
		ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_14_@ROOT } }
		goto = hold14
		random_owned_province = {
			limit = { has_province_flag = option_hold_14_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
		name = diggy.49.15
		ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_15_@ROOT } }
		goto = hold15
		random_owned_province = {
			limit = { has_province_flag = option_hold_15_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
		name = diggy.49.16
		ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_16_@ROOT } }
		goto = hold16
		random_owned_province = {
			limit = { has_province_flag = option_hold_16_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
		name = diggy.49.17
		ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_17_@ROOT } }
		goto = hold17
		random_owned_province = {
			limit = { has_province_flag = option_hold_17_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
		name = diggy.49.18
		ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_18_@ROOT } }
		goto = hold18
		random_owned_province = {
			limit = { has_province_flag = option_hold_18_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
		name = diggy.49.19
		ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_19_@ROOT } }
		goto = hold19
		random_owned_province = {
			limit = { has_province_flag = option_hold_19_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
		name = diggy.49.20
		ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_20_@ROOT } }
		goto = hold20
		random_owned_province = {
			limit = { has_province_flag = option_hold_20_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
		name = diggy.49.21
		ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_21_@ROOT } }
		goto = hold21
		random_owned_province = {
			limit = { has_province_flag = option_hold_21_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
		name = diggy.49.22
		ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_22_@ROOT } }
		goto = hold22
		random_owned_province = {
			limit = { has_province_flag = option_hold_22_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
		name = diggy.49.23
		ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_23_@ROOT } }
		goto = hold23
		random_owned_province = {
			limit = { has_province_flag = option_hold_23_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
		name = diggy.49.24
		ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_24_@ROOT } }
		goto = hold24
		random_owned_province = {
			limit = { has_province_flag = option_hold_24_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
		name = diggy.49.25
		ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_25_@ROOT } }
		goto = hold25
		random_owned_province = {
			limit = { has_province_flag = option_hold_25_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
		name = diggy.49.26
		ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_26_@ROOT } }
		goto = hold26
		random_owned_province = {
			limit = { has_province_flag = option_hold_26_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
		name = diggy.49.27
		ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_27_@ROOT } }
		goto = hold27
		random_owned_province = {
			limit = { has_province_flag = option_hold_27_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
		name = diggy.49.28
		ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_28_@ROOT } }
		goto = hold28
		random_owned_province = {
			limit = { has_province_flag = option_hold_28_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	option = {
		name = diggy.49.29
		ai_chance = { factor = 0 }
		trigger = { any_owned_province = { has_province_flag = option_hold_29_@ROOT } }
		goto = hold29
		random_owned_province = {
			limit = { has_province_flag = option_hold_29_@ROOT }
			start_digging_deeper_non_capital = yes
		}
		hidden_effect = { clr_digging_menu = yes }
	}
	#Go Back
	option = {
        name = diggy.49.30
        ai_chance = { factor = 0 }
		hidden_effect = { clr_digging_menu = yes }
	}
}
# Ovdal-Az-An survivors
country_event = {
    id = diggy.50
    title = diggy.50.t
    desc = diggy.50.d
    picture = COUNTRY_COLLAPSE_eventPicture
    
    fire_only_once = yes
    
    mean_time_to_happen = {
        years = 1
	}
    trigger = {
        owns = 4284
        culture_group = dwarven
        NOT = { is_year = 1550 }
	}
    #Let them join our army
    option = {
        name = diggy.50.a
        add_prestige = 25
        add_splendor = 1000
        define_general = {
            name = "Goblinsbane"
            trait = ruthless
            shock = 10
            fire = 6
            manuever = 8
            siege = 6
		}
        add_country_modifier = {
			name = legacy_of_goblinsbane
			duration = 9125
        }
    }
    
    #They should advise us instead
    option = {
        name = diggy.50.b
        add_prestige = 25
        add_splendor = 1000
        define_advisor = {
			type = commandant
			name = "Goblinsbane"
			skill = 3
			culture = granite_dwarf
			discount = yes
		}
            
        add_country_modifier = {
			name = legacy_of_goblinsbane
			duration = 9125
        }
    }
}

# Deepening the capital
country_event = {
    id = diggy.51
    title = diggy.51.t
    desc = diggy.51.d
    picture = ARTWORK_eventPicture
    
    is_triggered_only = yes
	
    trigger = {
		always = yes
	}
	
	immediate = {
		hidden_effect = { capital_scope = { setup_digging_deeper_capital = yes } }
	}
	
	after = {
		hidden_effect = { clr_country_flag = debug_digging_flag }
	}
	
    #Let's dig
    option = {
        name = diggy.51.a
		ai_chance = { factor = 0 }
        capital_scope = { start_digging_deeper = yes }
		hidden_effect = { set_country_flag = is_digging }
    }
    
    #Go back
    option = {
		ai_chance = { factor = 1 }
        name = diggy.51.b
    }
}

###############
##    AMLHARAZ
###############
# Forming the Amlharaz
country_event = {
    id = diggy.52
    title = diggy.52.t
    desc = diggy.52.d
    picture = ARTWORK_eventPicture
    
    is_triggered_only = yes
	
    trigger = {
		always = yes
	}
	
	immediate = {
		hidden_effect = {
			save_event_target_as = country
			if = {
				limit = { 4119 = { is_capital = no } }
				4119 = { add_core = I01 cede_province = I01 I01 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = I01 } } change_culture = kronium_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
				4149 = { add_core = I01 cede_province = I01 }
				4122 = { add_core = I01 cede_province = I01 }
				4128 = { add_core = I01 cede_province = I01 }
			}
			if = {
				limit = { 4208 = { is_capital = no } }
				4208 = { add_core = I02 cede_province = I02 I02 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = I02 } } change_culture = quartz_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
			if = {
				limit = { 4020 = { is_capital = no } }
				4020 = { add_core = I03 cede_province = I03 I03 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = I03 } } change_culture = sapphire_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
			if = {
				limit = { 4147 = { is_capital = no } }
				4147 = { add_core = I04 cede_province = I04 I04 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = I04 } } change_culture = ramsteel_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
			if = {
				limit = { 4236 = { is_capital = no } }
				4236 = { add_core = I05 cede_province = I05 I05 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = I05 } } change_culture = mithril_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
			if = {
				limit = { 2931 = { is_capital = no } }
				2931 = { add_core = I06 cede_province = I06 I06 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = I06 } } change_culture = dagrite_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
			if = {
				limit = { 2863 = { is_capital = no } }
				2863 = { add_core = I07 cede_province = I07 I07 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = I07 } } change_culture = agate_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
			if = {
				limit = { 2868 = { is_capital = no } }
				2868 = { add_core = I08 cede_province = I08 I08 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = I08 } } change_culture = platinum_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
			if = {
				limit = { 4056 = { is_capital = no } }
				4056 = { add_core = I09 cede_province = I09 I09 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = I09 } } change_culture = opal_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
			if = {
				limit = { 2963 = { is_capital = no } }
				2963 = { add_core = I10 cede_province = I10 I10 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = I10 } } change_culture = lead_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
			if = {
				limit = { 2942 = { is_capital = no } }
				2942 = { add_core = I11 cede_province = I11 I11 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = I11 } } change_culture = marble_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
			if = {
				limit = { 4238 = { is_capital = no } }
				4238 = { add_core = I12 cede_province = I12 I12 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = I12 } } change_culture = cobalt_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
			if = {
				limit = { 4100 = { is_capital = no } }
				4100 = { add_core = I13 cede_province = I13 I13 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = I13 } } change_culture = flint_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
			if = {
				limit = { 4217 = { is_capital = no } }
				4217 = { add_core = I14 cede_province = I14 I14 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = I14 } } change_culture = titanium_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
			if = {
				limit = { 4078 = { is_capital = no } }
				4078 = { add_core = I15 cede_province = I15 I15 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = I15 } } change_culture = pyrite_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
			if = {
				limit = { 4039 = { is_capital = no } }
				4039 = { add_core = I16 cede_province = I16 I16 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = I16 } } change_culture = basalt_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
			if = {
				limit = { 4218 = { is_capital = no } }
				4218 = { add_core = I17 cede_province = I17 I17 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = I17 } } change_culture = topaz_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
			if = {
				limit = { 4265 = { is_capital = no } }
				4265 = { add_core = I18 cede_province = I18 I18 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = I18 } } change_culture = peridot_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
			if = {
				limit = { 4284 = { is_capital = no } }
				4284 = { add_core = I19 cede_province = I19 I19 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = I19 } } change_culture = granite_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
			if = {
				limit = { 4266 = { is_capital = no } }
				4266 = { add_core = I20 cede_province = I20 I20 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = I20 } } change_culture = amethyst_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
			if = {
				limit = { 4350 = { is_capital = no } }
				4350 = { add_core = I21 cede_province = I21 I21 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = I21 } } change_culture = emerald_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
			if = {
				limit = { 4311 = { is_capital = no } }
				4311 = { add_core = I22 cede_province = I22 I22 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = I22 } } change_culture = jade_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
				4312 = { add_core = I22 cede_province = I22 change_religion = event_target:country change_culture = jade_dwarf }
				4313 = { add_core = I22 cede_province = I22 change_religion = event_target:country change_culture = jade_dwarf }
			}
			if = {
				limit = { 4323 = { is_capital = no } }
				4323 = { add_core = I25 cede_province = I25 I25 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = I25 } } change_culture = malachite_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
			if = {
				limit = { 4093 = { is_capital = no } }
				4093 = { add_core = H76 cede_province = H76 H76 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = H76 } } change_culture = diamond_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
			if = {
				limit = { 2973 = { is_capital = no } }
				2973 = { add_core = H77 cede_province = H77 H77 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = H77 } } change_culture = garnet_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
			if = {
				limit = { 4124 = { is_capital = no } }
				4124 = { add_core = H78 cede_province = H78 H78 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = H78 } } change_culture = citrine_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
			if = {
				limit = { 2914 = { is_capital = no } }
				2914 = { add_core = F47 cede_province = F47 F47 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = F47 } } change_culture = gold_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
			if = {
				limit = { 4247 = { is_capital = no } }
				4247 = { add_core = H79 cede_province = H79 H79 = { change_religion = event_target:country } ROOT = { create_subject = { subject_type = amlharaz_hold subject = H79 } } change_culture = amber_dwarf change_religion = event_target:country add_government_reform = amlharaz_reform }
			}
		}
	}
	
    #Let's form it!
    option = {
        name = diggy.52.a
		ai_chance = { factor = 1 }
		add_government_reform = amlharaz_reform
		every_country = {
			limit = { is_subject_of_type = amlharaz_hold is_subject_of = event_target:country }
			add_country_modifier = {
				name = amlharaz_autonomy
				duration = 3650
			}
			hidden_effect = {
				save_event_target_as = subject
				event_target:country = {
					every_owned_province = { remove_core = event_target:subject }
				}
				every_owned_province = { remove_core = event_target:country }
				add_yearly_manpower = 5
				add_stability_or_adm_power = yes
				add_legitimacy = 100
				add_republican_tradition = 100
				if = {
					limit = { NOT = { prestige = 0 } }
					add_prestige = 100
				}
				else = { add_prestige = 40 }
				add_country_modifier = {
					name = amlharaz_liberty_desire_10
					duration = -1
				}
			}
		}
		hidden_effect = { set_country_flag = amlharaz_political }
		country_event = { id = diggy.53 days = 30 }
    }
}

country_event = {
    id = diggy.53
    title = diggy.53.t
    desc = diggy.53.d
    picture = ARTWORK_eventPicture
    
    is_triggered_only = yes
	hidden = yes
	
    trigger = {
		always = yes
	}
	
    #Let's dig
    option = {
        name = diggy.53.a
		ai_chance = { factor = 1 }
		if = {
			limit = { has_country_flag = amlharaz_economic }
			clr_country_flag = amlharaz_economic 
			set_country_flag = amlharaz_military
			country_event = { id = diggy.55 }
		}
		else_if = {
			limit = { has_country_flag = amlharaz_military }
			clr_country_flag = amlharaz_military 
			set_country_flag = amlharaz_political
			country_event = { id = diggy.56 }
		}
		else_if = {
			limit = { has_country_flag = amlharaz_political }
			clr_country_flag = amlharaz_political 
			set_country_flag = amlharaz_economic
			country_event = { id = diggy.54 }
		}
    }
}

#Economic shit
country_event = {
    id = diggy.54
    title = diggy.54.t
    desc = diggy.54.d
    picture = ARTWORK_eventPicture
    
    is_triggered_only = yes
	
    trigger = {
		always = yes
	}
	
    #Build time + Dev Cost
    option = {
        name = diggy.54.a
		ai_chance = { factor = 1 }
		trigger = { NOT = { has_country_modifier = amlharaz_economic_1 } }
		hidden_effect = { set_country_flag = amlharaz_economic_1 }
		every_country = {
			limit = { is_subject_of_type = amlharaz_hold is_subject_of = ROOT }
			country_event = { id = diggy.57 days = 30 random = 150 }
		}
		hidden_effect = { country_event = { id = diggy.60 days = 200 } }
    }
	
	#Good Produced
    option = {
        name = diggy.54.b
		ai_chance = { factor = 1 }
		trigger = { NOT = { has_country_modifier = amlharaz_economic_2 } }
		hidden_effect = { set_country_flag = amlharaz_economic_2 }
		every_country = {
			limit = { is_subject_of_type = amlharaz_hold is_subject_of = ROOT }
			country_event = { id = diggy.57 days = 30 random = 150 }
		}
		hidden_effect = { country_event = { id = diggy.60 days = 200 } }
    }
	
	#Free Trade
    option = {
        name = diggy.54.c
		ai_chance = { factor = 1 }
		trigger = { NOT = { has_country_modifier = amlharaz_economic_3 } }
		hidden_effect = { set_country_flag = amlharaz_economic_3 }
		every_country = {
			limit = { is_subject_of_type = amlharaz_hold is_subject_of = ROOT }
			country_event = { id = diggy.57 days = 30 random = 150 }
		}
		hidden_effect = { country_event = { id = diggy.60 days = 200 } }
    }
	
	#Mercantilism
    option = {
        name = diggy.54.e
		ai_chance = { factor = 1 }
		trigger = { NOT = { has_country_modifier = amlharaz_economic_4 } }
		hidden_effect = { set_country_flag = amlharaz_economic_4 }
		every_country = {
			limit = { is_subject_of_type = amlharaz_hold is_subject_of = ROOT }
			country_event = { id = diggy.57 days = 30 random = 150 }
		}
		hidden_effect = { country_event = { id = diggy.60 days = 200 } }
    }
}

#Military shit
country_event = {
    id = diggy.55
    title = diggy.55.t
    desc = diggy.55.d
    picture = ARTWORK_eventPicture
    
    is_triggered_only = yes
	
    trigger = {
		always = yes
	}
	
    #Greater Army
    option = {
        name = diggy.55.a
		ai_chance = { factor = 1 }
		trigger = { NOT = { has_country_modifier = amlharaz_military_1 } }
		hidden_effect = { set_country_flag = amlharaz_military_1 }
		every_country = {
			limit = { is_subject_of_type = amlharaz_hold is_subject_of = ROOT }
			country_event = { id = diggy.58 days = 30 random = 150 }
		}
		hidden_effect = { country_event = { id = diggy.60 days = 200 } }
    }
	
	#Infantry CA
    option = {
        name = diggy.55.b
		ai_chance = { factor = 1 }
		trigger = { NOT = { has_country_modifier = amlharaz_military_2 } }
		hidden_effect = { set_country_flag = amlharaz_military_2 }
		every_country = {
			limit = { is_subject_of_type = amlharaz_hold is_subject_of = ROOT }
			country_event = { id = diggy.58 days = 30 random = 150 }
		}
		hidden_effect = { country_event = { id = diggy.60 days = 200 } }
    }
	
	#Canon backrow
    option = {
        name = diggy.55.c
		ai_chance = { factor = 1 }
		trigger = { NOT = { has_country_modifier = amlharaz_military_3 } }
		hidden_effect = { set_country_flag = amlharaz_military_3 }
		every_country = {
			limit = { is_subject_of_type = amlharaz_hold is_subject_of = ROOT }
			country_event = { id = diggy.58 days = 30 random = 150 }
		}
		hidden_effect = { country_event = { id = diggy.60 days = 200 } }
    }
	
	#Professionalism
    option = {
        name = diggy.55.e
		ai_chance = { factor = 1 }
		trigger = { NOT = { has_country_modifier = amlharaz_military_4 } }
		hidden_effect = { set_country_flag = amlharaz_military_4 }
		every_country = {
			limit = { is_subject_of_type = amlharaz_hold is_subject_of = ROOT }
			country_event = { id = diggy.58 days = 30 random = 150 }
		}
		hidden_effect = { country_event = { id = diggy.60 days = 200 } }
    }
}

#Political shit
country_event = {
    id = diggy.56
    title = diggy.56.t
    desc = diggy.56.d
    picture = ARTWORK_eventPicture
    
    is_triggered_only = yes
	
    trigger = {
		always = yes
	}
	
    #Recover War Exhaustion
    option = {
        name = diggy.56.a
		ai_chance = { factor = 1 }
		trigger = { NOT = { has_country_modifier = amlharaz_political_1 } }
		hidden_effect = { set_country_flag = amlharaz_political_1 }
		every_country = {
			limit = { is_subject_of_type = amlharaz_hold is_subject_of = ROOT }
			country_event = { id = diggy.59 days = 30 random = 150 }
		}
		hidden_effect = { country_event = { id = diggy.60 days = 200 } }
    }
	
	#Better Administration
    option = {
        name = diggy.56.b
		ai_chance = { factor = 1 }
		trigger = { NOT = { has_country_modifier = amlharaz_political_2 } }
		hidden_effect = { set_country_flag = amlharaz_political_2 }
		every_country = {
			limit = { is_subject_of_type = amlharaz_hold is_subject_of = ROOT }
			country_event = { id = diggy.59 days = 30 random = 150 }
		}
		hidden_effect = { country_event = { id = diggy.60 days = 200 } }
    }
	
	#Advisor
    option = {
        name = diggy.56.c
		ai_chance = { factor = 1 }
		trigger = { NOT = { has_country_modifier = amlharaz_political_3 } }
		hidden_effect = { set_country_flag = amlharaz_political_3 }
		every_country = {
			limit = { is_subject_of_type = amlharaz_hold is_subject_of = ROOT }
			country_event = { id = diggy.59 days = 30 random = 150 }
		}
		hidden_effect = { country_event = { id = diggy.60 days = 200 } }
    }
	
	#Vassal tax reduction
    option = {
        name = diggy.56.e
		ai_chance = { factor = 1 }
		trigger = { NOT = { has_country_modifier = amlharaz_political_4 } }
		hidden_effect = { set_country_flag = amlharaz_political_4 }
		every_country = {
			limit = { is_subject_of_type = amlharaz_hold is_subject_of = ROOT }
			country_event = { id = diggy.59 days = 30 random = 150 }
		}
		hidden_effect = { country_event = { id = diggy.60 days = 200 } }
    }
}

# Economic vote
country_event = {
    id = diggy.57
    title = diggy.57.t
	desc = {
		trigger = { I24 = { has_country_flag = amlharaz_economic_1 } }
		desc = diggy.57.da
	}
	desc = {
		trigger = { I24 = { has_country_flag = amlharaz_economic_2 } }
		desc = diggy.57.db
	}
	desc = {
		trigger = { I24 = { has_country_flag = amlharaz_economic_3 } }
		desc = diggy.57.dc
	}
	desc = {
		trigger = { I24 = { has_country_flag = amlharaz_economic_4 } }
		desc = diggy.57.dd
	}
    picture = ARTWORK_eventPicture
    
    is_triggered_only = yes
	
    trigger = {
		always = yes
	}
	
    #For
    option = {
        name = diggy.57.a
		ai_chance = { 
			factor = 50
			
			modifier = {
				factor = 1.5
				num_of_loans = 5
			}
			
			modifier = {
				factor = 2
				is_bankrupt = yes
			}
			modifier = {
				factor = 2
				personality = ai_capitalist
			}
			
			modifier = {
				factor = 1.5
				ruler_has_personality = midas_touched_personality
			}
			modifier = {
				factor = 1.5
				ruler_has_personality = architectural_visionary_personality
			}
			modifier = {
				factor = 1.5
				ruler_has_personality = entrepreneur_personality
			}
		}
		hidden_effect = {
			set_country_flag = for_amlharaz
			REB = { change_variable = { for_amlharaz = 1 } }
		}
    }
    
    #Against
    option = {
        name = diggy.57.b
		ai_chance = { 
			factor = 50
			
			modifier = {
				factor = 1.5
				num_of_loans = 5
			}
			
			modifier = {
				factor = 2
				is_bankrupt = yes
			}
			modifier = {
				factor = 2
				personality = ai_militarist
			}
			
			modifier = {
				factor = 1.5
				ruler_has_personality = embezzler_personality
			}
			modifier = {
				factor = 1.5
				ruler_has_personality = drunkard_personality
			}
			modifier = {
				factor = 1.5
				ruler_has_personality = malevolent_personality
			}
			modifier = {
				factor = 1.5
				liberty_desire = 65
			}
			modifier = {
				factor = 2
				liberty_desire = 85
			}
		}
		hidden_effect = {
			set_country_flag = against_amlharaz
			REB = { change_variable = { against_amlharaz = 1 } }
		}
    }
}

# Military vote
country_event = {
    id = diggy.58
    title = diggy.58.t
	desc = {
		trigger = { I24 = { has_country_flag = amlharaz_military_1 } }
		desc = diggy.58.da
	}
	desc = {
		trigger = { I24 = { has_country_flag = amlharaz_military_2 } }
		desc = diggy.58.db
	}
	desc = {
		trigger = { I24 = { has_country_flag = amlharaz_military_3 } }
		desc = diggy.58.dc
	}
	desc = {
		trigger = { I24 = { has_country_flag = amlharaz_military_4 } }
		desc = diggy.58.dd
	}
    picture = ARTWORK_eventPicture
    
    is_triggered_only = yes
	
    trigger = {
		always = yes
	}
	
    #For
    option = {
        name = diggy.58.a
		ai_chance = { 
			factor = 50
			
			modifier = {
				factor = 1.5
				manpower_percentage = 0.8
			}
			
			modifier = {
				factor = 2
				is_at_war = yes
			}
			modifier = {
				factor = 2
				has_subsidize_armies = yes
			}
			modifier = {
				factor = 2
				personality = ai_militarist
			}
			
			modifier = {
				factor = 1.5
				ruler_has_personality = conqueror_personality
			}
			modifier = {
				factor = 1.5
				ruler_has_personality = martial_educator_personality
			}
			modifier = {
				factor = 1.5
				ruler_has_personality = malevolent_personality
			}
		}
		hidden_effect = {
			set_country_flag = for_amlharaz
			REB = { change_variable = { for_amlharaz = 1 } }
		}
    }
    
    #Against
    option = {
        name = diggy.58.b
		ai_chance = { 
			factor = 50
			
			modifier = {
				factor = 1.5
				is_at_war = no
			}
			
			modifier = {
				factor = 2
				num_of_loans = 10
			}
			modifier = {
				factor = 2
				personality = ai_capitalist
			}
			
			modifier = {
				factor = 1.5
				ruler_has_personality = kind_hearted_personality
			}
			modifier = {
				factor = 1.5
				ruler_has_personality = scholar_personality
			}
			modifier = {
				factor = 1.5
				ruler_has_personality = righteous_personality
			}
			modifier = {
				factor = 1.5
				liberty_desire = 65
			}
			modifier = {
				factor = 2
				liberty_desire = 85
			}
		}
		hidden_effect = {
			set_country_flag = against_amlharaz
			REB = { change_variable = { against_amlharaz = 1 } }
		}
    }
}

# Political vote
country_event = {
    id = diggy.59
    title = diggy.59.t
	desc = {
		trigger = { I24 = { has_country_flag = amlharaz_political_1 } }
		desc = diggy.59.da
	}
	desc = {
		trigger = { I24 = { has_country_flag = amlharaz_political_2 } }
		desc = diggy.59.db
	}
	desc = {
		trigger = { I24 = { has_country_flag = amlharaz_political_3 } }
		desc = diggy.59.dc
	}
	desc = {
		trigger = { I24 = { has_country_flag = amlharaz_political_4 } }
		desc = diggy.59.dd
	}
    picture = ARTWORK_eventPicture
    
    is_triggered_only = yes
	
    trigger = {
		always = yes
	}
	
    #For
    option = {
        name = diggy.59.a
		ai_chance = { 
			factor = 50
			
			modifier = {
				factor = 1.5
				is_at_war = no
			}
			
			modifier = {
				factor = 2
				has_support_loyalists = yes
			}
			modifier = {
				factor = 2
				personality = ai_diplomat
			}
			
			modifier = {
				factor = 1.5
				ruler_has_personality = scholar_personality
			}
			modifier = {
				factor = 1.5
				ruler_has_personality = charismatic_negotiator_personality
			}
			modifier = {
				factor = 1.5
				ruler_has_personality = silver_tongue_personality
			}
		}
		hidden_effect = {
			set_country_flag = for_amlharaz
			REB = { change_variable = { for_amlharaz = 1 } }
		}
    }
    
    #Against
    option = {
        name = diggy.59.b
		ai_chance = { 
			factor = 50
			
			modifier = {
				factor = 1.5
				corruption = 5
			}
			
			modifier = {
				factor = 2
				dip = I24
			}
			modifier = {
				factor = 2
				personality = ai_balanced
			}
			
			modifier = {
				factor = 1.5
				ruler_has_personality = fierce_negotiator_personality
			}
			modifier = {
				factor = 1.5
				ruler_has_personality = cruel_personality
			}
			modifier = {
				factor = 1.5
				ruler_has_personality = malevolent_personality
			}
			modifier = {
				factor = 1.5
				liberty_desire = 65
			}
			modifier = {
				factor = 2
				liberty_desire = 85
			}
		}
		hidden_effect = {
			set_country_flag = against_amlharaz
			REB = { change_variable = { against_amlharaz = 1 } }
		}
    }
}

# Result of the vote
country_event = {
    id = diggy.60
    title = diggy.60.t
    desc = diggy.60.d
    picture = ARTWORK_eventPicture
    
    is_triggered_only = yes
	
    trigger = {
		always = yes
	}
	
	immediate = {
		hidden_effect = {
			clr_country_flag = enacted_amlharaz
			clr_country_flag = denied_amlharaz
		}
	}
	
	after = {
		hidden_effect = {
			every_subject_country = {
				limit = { is_subject_of_type = amlharaz_hold }
				clr_country_flag = for_amlharaz
				clr_country_flag = against_amlharaz
			}
			REB = {
				set_variable = { for_amlharaz = 0 }
				set_variable = { against_amlharaz = 0 }
			}
			clr_country_flag = amlharaz_economic_1
			clr_country_flag = amlharaz_economic_2
			clr_country_flag = amlharaz_economic_3
			clr_country_flag = amlharaz_economic_4
			clr_country_flag = amlharaz_military_1
			clr_country_flag = amlharaz_military_2
			clr_country_flag = amlharaz_military_3
			clr_country_flag = amlharaz_military_4
			clr_country_flag = amlharaz_political_1
			clr_country_flag = amlharaz_political_2
			clr_country_flag = amlharaz_political_3
			clr_country_flag = amlharaz_political_4
		}
	}
	
    #Enact it
    option = {
        name = diggy.60.a
		ai_chance = { factor = 50 }
		trigger_switch = {
			on_trigger = has_country_flag
			
			amlharaz_economic_1 = { add_country_modifier = { name = amlharaz_economic_1 duration = 7300 } every_country = { limit = { is_subject_of = ROOT is_subject_of_type = amlharaz_hold } add_country_modifier = { name = amlharaz_economic_1 duration = 7300 } } }
			amlharaz_economic_2 = { add_country_modifier = { name = amlharaz_economic_2 duration = 7300 } every_country = { limit = { is_subject_of = ROOT is_subject_of_type = amlharaz_hold } add_country_modifier = { name = amlharaz_economic_2 duration = 7300 } } }
			amlharaz_economic_3 = { add_country_modifier = { name = amlharaz_economic_3 duration = 7300 } every_country = { limit = { is_subject_of = ROOT is_subject_of_type = amlharaz_hold } add_country_modifier = { name = amlharaz_economic_3 duration = 7300 } } }
			amlharaz_economic_4 = { add_country_modifier = { name = amlharaz_economic_4 duration = 7300 } add_mercantilism = 5 every_country = { limit = { is_subject_of = ROOT is_subject_of_type = amlharaz_hold } add_country_modifier = { name = amlharaz_economic_4 duration = 7300 } add_mercantilism = 5 } }
			amlharaz_military_1 = { add_country_modifier = { name = amlharaz_military_1 duration = 7300 } every_country = { limit = { is_subject_of = ROOT is_subject_of_type = amlharaz_hold } add_country_modifier = { name = amlharaz_military_1 duration = 7300 } } }
			amlharaz_military_2 = { add_country_modifier = { name = amlharaz_military_2 duration = 7300 } every_country = { limit = { is_subject_of = ROOT is_subject_of_type = amlharaz_hold } add_country_modifier = { name = amlharaz_military_2 duration = 7300 } } }
			amlharaz_military_3 = { add_country_modifier = { name = amlharaz_military_3 duration = 7300 } every_country = { limit = { is_subject_of = ROOT is_subject_of_type = amlharaz_hold } add_country_modifier = { name = amlharaz_military_3 duration = 7300 } } }
			amlharaz_military_4 = { add_country_modifier = { name = amlharaz_military_4 duration = 7300 } every_country = { limit = { is_subject_of = ROOT is_subject_of_type = amlharaz_hold } add_country_modifier = { name = amlharaz_military_4 duration = 7300 } } }
			amlharaz_political_1 = { add_country_modifier = { name = amlharaz_political_1 duration = 7300 } every_country = { limit = { is_subject_of = ROOT is_subject_of_type = amlharaz_hold } add_country_modifier = { name = amlharaz_political_1 duration = 7300 } } }
			amlharaz_political_2 = { add_country_modifier = { name = amlharaz_political_2 duration = 7300 } every_country = { limit = { is_subject_of = ROOT is_subject_of_type = amlharaz_hold } add_country_modifier = { name = amlharaz_political_2 duration = 7300 } } }
			amlharaz_political_3 = { add_country_modifier = { name = amlharaz_political_3 duration = 7300 } every_country = { limit = { is_subject_of = ROOT is_subject_of_type = amlharaz_hold } add_country_modifier = { name = amlharaz_political_3 duration = 7300 } } }
			amlharaz_political_4 = { add_country_modifier = { name = amlharaz_political_4 duration = 7300 } every_country = { limit = { is_subject_of = ROOT is_subject_of_type = amlharaz_hold } add_country_modifier = { name = amlharaz_political_4 duration = 7300 } } }
		}
		hidden_effect = { set_country_flag = enacted_amlharaz }
		hidden_effect = { amlharaz_hold_vote = yes }
		country_event = { id = diggy.53 days = 1825 }
    }
    
    #Don't enact it
    option = {
		ai_chance = { factor = 50 }
        name = diggy.60.b
		hidden_effect = { set_country_flag = denied_amlharaz }
		hidden_effect = { amlharaz_hold_vote = yes }
		country_event = { id = diggy.53 days = 1825 }
    }
}

#####################################################################
##### AI helps & Debug Event
#####################################################################
#Dev help for main AI hold
country_event = {
	id = diggy.100
	title = diggy.100.t
	desc = diggy.100.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		years = 8 #dev cost change would make it happen faster otherwise
		
		modifier = {
			factor = 0.75
			capital_scope = { continent = serpentspine }
		}
		
		modifier = {
			factor = 2
			is_subject = yes
		}
		
		modifier = {
			factor = 1.2
			
			has_province_modifier = orc_hold_arena
		}
		
		modifier = {
			factor = 1.2
			
			has_province_modifier = orc_hold_barrack
		}
		
		modifier = {
			factor = 1.2
			
			has_province_modifier = orc_hold_raider
		}
	}
	
	hidden = yes
	
	trigger = {
		OR = {
			OR = {
				has_country_modifier = dwarven_administration
				capital_scope = { has_integrated_dwarven_pop_trigger = yes }
			}
			AND = {
				capital_scope = { has_integrated_dwarven_pop_trigger = yes }
				adm_tech = 7
			}
			AND = {
				capital_scope = { has_subterranean_race = yes }
				adm_tech = 7 #bugfix. Passive hold dev gain starts at adm 7 for noncap holds
			}
		}
		OR = {
			capital_scope = { NOT = { development = 40 } has_province_modifier = dig_1 }
			capital_scope = { NOT = { development = 50 } has_province_modifier = dig_2 }
			capital_scope = { NOT = { development = 60 } has_province_modifier = dig_3 }
			capital_scope = { NOT = { development = 70 } has_province_modifier = dig_4 }
			capital_scope = { NOT = { development = 80 } has_province_modifier = dig_5 }
			capital_scope = { NOT = { development = 90 } has_province_modifier = dig_6 }
			capital_scope = { NOT = { development = 100 } has_province_modifier = dig_7 }
			capital_scope = { NOT = { development = 110 } has_province_modifier = dig_8 }
			capital_scope = { NOT = { development = 120 } has_province_modifier = dig_9 }
			capital_scope = { NOT = { development = 130 } has_province_modifier = dig_10 province_id = 4119 }
			capital_scope = { NOT = { development = 130 } has_province_modifier = dig_10 province_id = 4311 }
		}
		NOT = { capital_scope =  { has_province_modifier = infested_hold } }
		NOT = { capital_scope = { has_province_modifier = ruined_hold } }
		ai = yes
	}
	
	#Profit
	option = {
        name = diggy.100.a
        ai_chance = { factor = 100 }
		capital_scope = {
			add_base_manpower = 1
			add_base_tax = 1
			add_base_production = 1
			add_next_institution_embracement_scaled = 15
		}
	}
}
#Passive dev gain for other hold Don't go higher than 100 dev
province_event = {
	id = diggy.101
	title = diggy.100.t
	desc = diggy.100.d
	picture = ARTWORK_eventPicture
	goto = root
	
	mean_time_to_happen = {
		years = 7 #to slow it down with the dev cost counting changes
		
		modifier = {
			factor = 1.2
			
			has_province_modifier = orc_hold_arena
		}
		
		modifier = {
			factor = 1.2
			
			has_province_modifier = orc_hold_barrack
		}
		
		modifier = {
			factor = 1.2
			
			has_province_modifier = orc_hold_raider
		}
		
		modifier = {
			factor = 0.95 #nerfing other sources of hold dev gain. Making it care about build time
			
			has_integrated_dwarven_pop_trigger = yes
		}
		
		modifier = {
			factor = 0.75 #nerfing other sources of hold dev gain. Making it care about build time
			
			owner = { has_age_ability = ab_dwarven_reclamation }
		}
		
		modifier = {
			factor = 0.9 #nerfing other sources of hold dev gain. Making it care about build time
			
			owner = { in_golden_age = yes }
		}
		
		modifier = {
			factor = 0.95 #nerfing other sources of hold dev gain. Making it care about build time
			
			owner = { has_country_flag = formed_diggy_formable }
		}
		
		modifier = {
			factor = 0.95 #nerfing other sources of hold dev gain. Making it care about build time
			
			owner = { tag = I24 } #Aul-Dwarov 
		}
		
		modifier = {
			factor = 0.9 #nerfing other sources of hold dev gain. Making it care about build time
			owner = { owns = 676 }
			676 = { has_province_modifier = the_harpylen_dam }
		}
		
		modifier = {
			factor = 0.9 #nerfing other sources of hold dev gain. Making it care about build time
			owner = { has_country_modifier = dadv_childrens_of_the_dwarovar }
		}
		
		modifier = {
			factor = 100
			
			OR = {
				has_integrated_kobold_pop_trigger = yes
				has_integrated_goblin_pop_trigger = yes
			}
			owner = { NOT = { adm_tech = 7 } }
		}

		modifier = {
			factor = 0.96
			
			#ai is dumb
			owner = { 
				ai = yes
			}
		}

		modifier = {
			factor = 0.96
			
			#dev cost reduction
			owner = { 
				has_global_modifier_value = {
					which = build_time
					value = -0.05
				}
			}
		}

		modifier = {
			factor = 0.96
			
			#dev cost reduction
			owner = { 
				has_global_modifier_value = {
					which = build_time
					value = -0.1
				}
			}
		}

		modifier = {
			factor = 0.96
			
			#dev cost reduction
			owner = { 
				has_global_modifier_value = {
					which = build_time
					value = -0.15
				}
			}
		}

		modifier = {
			factor = 0.96
			
			#dev cost reduction
			owner = { 
				has_global_modifier_value = {
					which = build_time
					value = -0.2
				}
			}
		}

		modifier = {
			factor = 0.96
			
			#dev cost reduction
			owner = { 
				has_global_modifier_value = {
					which = build_time
					value = -0.25
				}
			}
		}

		modifier = {
			factor = 0.96
			
			#dev cost reduction
			owner = { 
				has_global_modifier_value = {
					which = build_time
					value = -0.3
				}
			}
		}

		modifier = {
			factor = 0.96
			
			#dev cost reduction
			owner = { 
				has_global_modifier_value = {
					which = build_time
					value = -0.35
				}
			}
		}

		modifier = {
			factor = 0.96
			
			#dev cost reduction
			owner = { 
				has_global_modifier_value = {
					which = build_time
					value = -0.4
				}
			}
		}

		modifier = {
			factor = 0.96
			
			#dev cost reduction
			owner = { 
				has_global_modifier_value = {
					which = build_time
					value = -0.45
				}
			}
		}

		modifier = {
			factor = 0.96
			
			#dev cost reduction
			owner = { 
				has_global_modifier_value = {
					which = build_time
					value = -0.5
				}
			}
		}
	}
	
	hidden = yes
	
	trigger = {
		OR = {
			has_terrain = dwarven_hold
			has_terrain = dwarven_hold_surface
		}
		has_subterranean_race = yes
		OR = {
			AND = { NOT = { development = 40 } has_province_modifier = dig_1 }
			AND = { NOT = { development = 50 } has_province_modifier = dig_2 }
			AND = { NOT = { development = 60 } has_province_modifier = dig_3 }
			AND = { NOT = { development = 70 } has_province_modifier = dig_4 }
			AND = { NOT = { development = 80 } has_province_modifier = dig_5 }
			AND = { NOT = { development = 90 } has_province_modifier = dig_6 }
			AND = { NOT = { development = 100 } has_province_modifier = dig_7 }
		}
		is_capital = no
	}
	
	#Profit
	option = {
        name = diggy.100.a
        ai_chance = { factor = 100 }
		random = {
			chance = 50
			add_base_tax = 1
		}
		random = {
			chance = 50
			add_base_manpower = 1
		}
		random = {
			chance = 50
			add_base_production = 1
		}
	}
}

###Marrhold setup
country_event = {
	id = diggy.104
	title = diggy.100.t
	desc = diggy.100.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		months = 1
	}
	
	hidden = yes
	
	trigger = {
		2931 = {
			trade_share = {
				country = ROOT
				share = 1
			}
		}
		NOT = {
			2931 = {
				has_trade_modifier = {
					who = ROOT
					key = MARRHOLD_CLOSED
				}
			}
		}
		NOT = { any_owned_province = { superregion = west_serpentspine_superregion } }
		NOT = { has_global_flag = marrhold_canal }
	}
	
	option = {
        name = diggy.100.a
        ai_chance = { factor = 100 }
		2931 = {
			add_trade_modifier = {
				who = ROOT
				duration = -1
				power = -1000
				key = MARRHOLD_CLOSED
			}
		}
	}
}
##Marrhold open
country_event = {
	id = diggy.105
	title = diggy.105.t
	desc = diggy.105.d
	picture = ARTWORK_eventPicture
	
	major = yes
	
	mean_time_to_happen = {
		months = 1
	}
	
	fire_only_once = yes
	
	trigger = {
		4097 = { has_great_project = marrhold_tunnel }
		owns = 4097
	}
	
	option = {
        name = diggy.105.a
        ai_chance = { factor = 100 }
		4097 = {
			add_permanent_province_modifier = {
				name = marrhold_door
				duration = -1
			}
			center_of_trade = 1
		}
		hidden_effect = { set_global_flag = marrhold_canal }
		every_country = {
			limit = {
				2931 = {
					has_trade_modifier = {
						who = PREV
						key = MARRHOLD_CLOSED
					}
				}
			}
			2931 = {
				remove_trade_modifier = {
					who = PREV
					key = MARRHOLD_CLOSED
				}
			}
		}
	}
}
##Random setup for special cave
country_event = {
	id = diggy.106
	title = diggy.106.t
	desc = diggy.106.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	hidden = yes
	
	trigger = {
		always = yes
	}
	
	option = {
        name = diggy.106.a
        ai_chance = { factor = 100 }
		REB = {
			set_variable = {
				which = variable:nbSpecialCavern
				value = 0
			}
		}
		while = {
			limit = {
				NOT = {
					REB = {
						check_variable = {
							which = variable:nbSpecialCavern
							value = 40
						}
					}
				}
			}
			random_province = {
				limit = {
					has_terrain = cavern
					NOT = { has_province_flag = special_cavern }
					continent = serpentspine
					is_city = no
				}
				set_province_flag = special_cavern
				add_permanent_province_modifier = {
					name = special_cave
					duration = -1
				}
			}
			REB = {
				change_variable = {
					which = variable:nbSpecialCavern
					value = 1
				}
			}
		}
	}
}

##Make hold capital
country_event = {
	id = diggy.107
	title = diggy.107.t
	desc = diggy.107.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		years = 1
	}
	
	hidden = yes
	
	trigger = {
		OR = {
			has_country_modifier = dwarven_administration
			#no reason why only dwarves would move their capital to a hold if it's not in one. Especially since these guys don't dig otherwise
			primary_culture = cave_goblin
			primary_culture = black_orc
			tag = Z55 #darkscale
			tag = Z56 #syz
		}
		capital_scope = {
			NOT = { has_terrain = dwarven_hold }
			NOT = { has_terrain = dwarven_hold_surface }
		}
		any_owned_province = {
			OR = {
				has_terrain = dwarven_hold
				has_terrain = dwarven_hold_surface
			}
			is_city = yes
			is_core = ROOT #don't move the cap to a noncore province
		}
		#NOT = { has_country_flag = capital_to_hold } #we don't need this. It's an unecessary check
		ai = yes
	}
	
	option = {
        name = diggy.107.a
        ai_chance = { factor = 100 }
		random_owned_province = {
			limit = {
				OR = {
					has_terrain = dwarven_hold
					has_terrain = dwarven_hold_surface
				}
				is_city = yes
				is_core = ROOT #don't move the cap to a noncore province
			}
			move_capital_effect = yes
		}
		set_country_flag = capital_to_hold
	}
}

##Starting Bonus
country_event = {
	id = diggy.108
	title = diggy.108.t
	desc = diggy.108.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	fire_only_once = yes
	
	hidden = yes
	
	trigger = {
		always = yes
	}
	
	option = {
        name = diggy.108.a
        ai_chance = { factor = 100 }
		every_country = {
			limit = {
				OR = {
					AND = {
						capital_scope = {
							OR = {
								superregion = east_serpentspine_superregion
								superregion = west_serpentspine_superregion
							}
						}
						NOT = { total_development = 10 }
					}
					has_reform = dwarovar_squatter
				}
			}
			add_country_modifier = {
				name = dwarovar_claimer
				duration = 18250
			}
		}
		every_country = {
			limit = { has_country_modifier = remnant_legacy }
			#add_country_modifier = {
			#	name = inward_military
			#	duration = 18250
			#}
			country_event = { id = diggy.40 }
		}
	}
}


##Migration tweak
country_event = {
	id = diggy.109
	title = diggy.109.t
	desc = diggy.109.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		months = 6
	}
	
	hidden = yes
	
	trigger = {
		OR = {
			AND = {
				ai = no
				has_country_modifier = diggy_ai_uprising_buff
			}
			AND = {
				OR = {
					has_reform = adventurer_reform
					has_reform = dwarovar_warband
					has_reform = roaming_horde
				}
				OR = {
					if = {
						limit = {
							ai = yes
						}
						num_of_cities = 2 #stop ai migration if they have conquered something
					}
					else = {
						num_of_cities = 3 # give the player a buffer for purging warbands	
					}
					capital_scope = { #stop migrating if you have a hold
						continent = serpentspine
						OR = {
							has_terrain = dwarven_hold
							has_terrain = dwarven_hold_surface
						}
					}
				}
			}
		}
	}
	
	option = {
        name = diggy.109.a
		ai_chance = { factor = 100 }
		if = {
			limit = {
				ai = no
				has_country_modifier = diggy_ai_uprising_buff
			}
			remove_country_modifier = diggy_ai_uprising_buff
		}
		else = {
			if = { #ai stop migrate
				limit = {
					ai = yes
				}
				add_country_modifier = {
					name = diggy_stop_migrate
					duration = -1
				}
				add_country_modifier ={
					name = diggy_ai_uprising_buff
					duration = -1
				}
				remove_country_modifier = dont_colonize_but_migrate #might as well remove this for a tag switching player but eh
				if = {
					limit = {
						capital_scope = { #stop migrating if you have a hold
							continent = serpentspine
							OR = {
								has_terrain = dwarven_hold
								has_terrain = dwarven_hold_surface
							}
						}
						NOT = { has_country_flag = diggy_bankruptcy_help }
					}
					add_country_modifier = { #stop the ai from going bankrupt when it grabs a hold and starts colonizing
						name = dwarovar_hold_bankruptcy_fix
						duration = 1825
					}
					add_treasury = 240 #pay off their loans from the hold
					set_country_flag = diggy_bankruptcy_help
				}
			}
			if = {
				limit = {
					OR = {
						AND = {
							NOT = { ai = yes } # don't remove the attrition fix from a player if they have just a hold. Because they may want to migrate through
							num_of_cities = 3 #again the player might be in a weird situation where they need the buffer for purging
						}
						ai = yes
					}
				}
				remove_country_modifier = warband_attrition_fix #remove this for the player too
				remove_country_modifier = diggy_ai_uprising_buff #for all you tag switching players out there
				remove_country_modifier = dont_colonize_but_migrate
			}
		}
	}
}
##SETUP EVENT
country_event = {
	id = diggy.110
	title = diggy.110.t
	desc = diggy.110.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	hidden = yes
	trigger = {
		always = yes
	}
	
	option = {
        name = diggy.111.a
        ai_chance = { factor = 100 }
		every_province = {
			limit = {
				OR = {
					has_terrain = dwarven_hold
					has_terrain = dwarven_hold_surface
				}
			}
			add_province_triggered_modifier = hold_has_parliament
			add_province_triggered_modifier = gold_hold
			add_province_triggered_modifier = no_subterannean_race
		}
	}
}

##Building Black Orc Shit in Dwarovar
province_event = {
	id = diggy.112
	title = diggy.112.t
	desc = diggy.112.d
	picture = ARTWORK_eventPicture
	goto = root
	
	is_triggered_only = yes
	hidden = yes
	
	trigger = {
		OR = {
			has_province_modifier = black_orc_building_1
			has_province_modifier = black_orc_building_2
			has_province_modifier = black_orc_building_3
		}
	}
	
	option = {
        name = diggy.112.a
        ai_chance = { factor = 100 }
		if = {
			limit = { has_province_modifier = black_orc_building_1 }
			remove_province_modifier = black_orc_building_1
			add_province_modifier = {
				name = orc_hold_barrack
				duration = -1
			}
		}
		else_if = {
			limit = { has_province_modifier = black_orc_building_2 }
			remove_province_modifier = black_orc_building_2
			add_province_modifier = {
				name = orc_hold_raider
				duration = -1
			}
		}
		else_if = {
			limit = { has_province_modifier = black_orc_building_3 }
			remove_province_modifier = black_orc_building_3
			add_province_modifier = {
				name = orc_hold_arena
				duration = -1
			}
		}
	}
}

###Marrhold setup
country_event = {
	id = diggy.113
	title = diggy.100.t
	desc = diggy.100.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		months = 1
	}
	
	hidden = yes
	
	trigger = {
		2931 = {
			has_trade_modifier = {
				who = ROOT
				key = MARRHOLD_CLOSED
			}
		}
		any_owned_province = { superregion = west_serpentspine_superregion }
	}
	
	option = {
        name = diggy.100.a
        ai_chance = { factor = 100 }
		2931 = {
			remove_trade_modifier = {
				who = ROOT
				key = MARRHOLD_CLOSED
			}
		}
	}
}

#remove flag when is no longer valable
country_event = {
	id = diggy.114
	title = diggy.1.t
	desc = diggy.1.d
	picture = CITY_DEVELOPMENT_eventPicture
	
	mean_time_to_happen = {
		days = 1
	}
	hidden = yes
	
	trigger = {
		has_country_flag = is_digging
		capital_scope = { NOT = { has_construction = digging_deeper } }
	}
	
	option = {
        name = diggy.1.a
        ai_chance = { factor = 100 }
		clr_country_flag = is_digging
		clr_country_flag = dig_prod
		clr_country_flag = dig_manpower
		clr_country_flag = dig_culture
		clr_country_flag = dig_explosive
		remove_country_modifier = dig_prod
		remove_country_modifier = dig_manpower
		remove_country_modifier = dig_explosive
	}
}

#Debug construction
country_event = {
	id = diggy.115
	title = diggy.1.t
	desc = diggy.1.d
	picture = CITY_DEVELOPMENT_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	option = {
        name = diggy.1.a
        ai_chance = { factor = 100 }
		hidden_effect = { capital_scope = { change_variable = { cons_prog = 0.5 } } }
		tooltip = { capital_scope = { change_variable = { cons_prog = 1 } } }
	}
	
	option = {
        name = diggy.1.a
        ai_chance = { factor = 100 }
		capital_scope = { 
			add_base_tax = 4
			add_base_manpower = 3
			add_base_production = 3
		}
	}
}


##Migration tweak
#country_event = { #redundant
#	id = diggy.116
#	title = diggy.116.t
#	desc = diggy.116.d
#	picture = ARTWORK_eventPicture
#	
#	mean_time_to_happen = {
#		months = 2
#	}
#	
#	hidden = yes
#	
#	trigger = { # If AI conquers a province from another, allow colonization since migration is no longer possible
#		OR = {
#			has_reform = adventurer_reform
#			has_reform = dwarovar_warband
#			has_reform = roaming_horde
#		}
#		num_of_cities = 2
#		capital_scope = {
#			continent = serpentspine
#		}
#		has_country_modifier = dont_colonize_but_migrate
#		ai = yes
#	}
#	
#	option = {
#        name = diggy.116.a
#        ai_chance = { factor = 100 }
#		remove_country_modifier = dont_colonize_but_migrate
#	}
#}

##Ovdal Lodhum Start Flavour for Gerin Orcrend
country_event = {
	id = diggy.117
	title = diggy.117.t
	desc = diggy.117.d
	picture = SWORD_OF_OSMAN_eventPicture
	
	fire_only_once = yes
	mean_time_to_happen = {
		days = 10
	}
	
	trigger = {
		is_year = 1444
		NOT = { has_country_flag = flag_of_gerin_orcrend }
		tag = H77
	}
	
	immediate = {
		set_country_flag = flag_of_gerin_orcrend
	}
	option = { #Long may he reign
		name = diggy.117.a
		ai_chance = { factor = 100 }
		add_ruler_modifier = { 
			name = reign_of_gerin_orcrend #Morale, AT, movement speed
			duration = -1
		}
	}
}

#construction check
province_event = {
	id = diggy.118
	title = diggy.118.t
	desc = diggy.118.d
	picture = FORT_eventPicture
	
	hidden = yes
	
	trigger = {
		is_capital = yes
		has_construction = digging_deeper
		NOT = { construction_progress = 0.99 }
		if = { limit = { construction_progress = 0.50 }
			if = { limit = { construction_progress = 0.75 }
				if = { limit = { construction_progress = 0.87 }
					if = { limit = { construction_progress = 0.93 }
						if = { limit = { construction_progress = 0.96 }
							if = { limit = { construction_progress = 0.98 }
								check_variable = { cons_prog = 0.02 }
							}
							else = {
								check_variable = { cons_prog = 0.04 }
							}
						}
						else = {
							if = { limit = { construction_progress = 0.95 }
								check_variable = { cons_prog = 0.05 }
							}
							else = {
								check_variable = { cons_prog = 0.07 }
							}
						}
					}
					else = {
						if = { limit = { construction_progress = 0.90 }
							if = { limit = { construction_progress = 0.92 }
								check_variable = { cons_prog = 0.08 }
							}
							else = {
								check_variable = { cons_prog = 0.10 }
							}
						}
						else = {
							if = { limit = { construction_progress = 0.89 }
								check_variable = { cons_prog = 0.11 }
							}
							else = {
								check_variable = { cons_prog = 0.13 }
							}
						}
					}
				}
				else = {
					if = { limit = { construction_progress = 0.81 }
						if = { limit = { construction_progress = 0.84 }
							if = { limit = { construction_progress = 0.85 }
								check_variable = { cons_prog = 0.15 }
							}
							else = {
								check_variable = { cons_prog = 0.16 }
							}
						}
						else = {
							if = { limit = { construction_progress = 0.82 }
								check_variable = { cons_prog = 0.18 }
							}
							else = {
								check_variable = { cons_prog = 0.19 }
							}
						}
					}
					else = {
						if = { limit = { construction_progress = 0.78 }
							if = { limit = { construction_progress = 0.79 }
								check_variable = { cons_prog = 0.21 }
							}
							else = {
								check_variable = { cons_prog = 0.22 }
							}
						}
						else = {
							if = { limit = { construction_progress = 0.76 }
								check_variable = { cons_prog = 0.24 }
							}
							else = {
								check_variable = { cons_prog = 0.25 }
							}
						}
					}
				}
			}
			else = {
				if = { limit = { construction_progress = 0.62 }
					if = { limit = { construction_progress = 0.68 }
						if = { limit = { construction_progress = 0.71 }
							if = { limit = { construction_progress = 0.73 }
								check_variable = { cons_prog = 0.27 }
							}
							else = {
								check_variable = { cons_prog = 0.29 }
							}
						}
						else = {
							if = { limit = { construction_progress = 0.70 }
								check_variable = { cons_prog = 0.30 }
							}
							else = {
								check_variable = { cons_prog = 0.32 }
							}
						}
					}
					else = {
						if = { limit = { construction_progress = 0.65 }
							if = { limit = { construction_progress = 0.67 }
								check_variable = { cons_prog = 0.33 }
							}
							else = {
								check_variable = { cons_prog = 0.35 }
							}
						}
						else = {
							if = { limit = { construction_progress = 0.64 }
								check_variable = { cons_prog = 0.36 }
							}
							else = {
								check_variable = { cons_prog = 0.38 }
							}
						}
					}
				}
				else = {
					if = { limit = { construction_progress = 0.56 }
						if = { limit = { construction_progress = 0.59 }
							if = { limit = { construction_progress = 0.60 }
								check_variable = { cons_prog = 0.40 }
							}
							else = {
								check_variable = { cons_prog = 0.41 }
							}
						}
						else = {
							if = { limit = { construction_progress = 0.57 }
								check_variable = { cons_prog = 0.43 }
							}
							else = {
								check_variable = { cons_prog = 0.44 }
							}
						}
					}
					else = {
						if = { limit = { construction_progress = 0.53 }
							if = { limit = { construction_progress = 0.54 }
								check_variable = { cons_prog = 0.46 }
							}
							else = {
								check_variable = { cons_prog = 0.47 }
							}
						}
						else = {
							if = { limit = { construction_progress = 0.51 }
								check_variable = { cons_prog = 0.49 }
							}
							else = {
								check_variable = { cons_prog = 0.50 }
							}
						}
					}
				}
			}
		}
		else = {
			if = { limit = { construction_progress = 0.25 }
				if = { limit = { construction_progress = 0.37 }
					if = { limit = { construction_progress = 0.43 }
						if = { limit = { construction_progress = 0.46 }
							if = { limit = { construction_progress = 0.48 }
								check_variable = { cons_prog = 0.52 }
							}
							else = {
								check_variable = { cons_prog = 0.54 }
							}
						}
						else = {
							if = { limit = { construction_progress = 0.45 }
								check_variable = { cons_prog = 0.55 }
							}
							else = {
								check_variable = { cons_prog = 0.57 }
							}
						}
					}
					else = {
						if = { limit = { construction_progress = 0.40 }
							if = { limit = { construction_progress = 0.42 }
								check_variable = { cons_prog = 0.58 }
							}
							else = {
								check_variable = { cons_prog = 0.60 }
							}
						}
						else = {
							if = { limit = { construction_progress = 0.39 }
								check_variable = { cons_prog = 0.61 }
							}
							else = {
								check_variable = { cons_prog = 0.63 }
							}
						}
					}
				}
				else = {
					if = { limit = { construction_progress = 0.31 }
						if = { limit = { construction_progress = 0.34 }
							if = { limit = { construction_progress = 0.35 }
								check_variable = { cons_prog = 0.65 }
							}
							else = {
								check_variable = { cons_prog = 0.66 }
							}
						}
						else = {
							if = { limit = { construction_progress = 0.32 }
								check_variable = { cons_prog = 0.68 }
							}
							else = {
								check_variable = { cons_prog = 0.69 }
							}
						}
					}
					else = {
						if = { limit = { construction_progress = 0.28 }
							if = { limit = { construction_progress = 0.29 }
								check_variable = { cons_prog = 0.71 }
							}
							else = {
								check_variable = { cons_prog = 0.72 }
							}
						}
						else = {
							if = { limit = { construction_progress = 0.26 }
								check_variable = { cons_prog = 0.74 }
							}
							else = {
								check_variable = { cons_prog = 0.75 }
							}
						}
					}
				}
			}
			else = {
				if = { limit = { construction_progress = 0.12 }
					if = { limit = { construction_progress = 0.18 }
						if = { limit = { construction_progress = 0.21 }
							if = { limit = { construction_progress = 0.23 }
								check_variable = { cons_prog = 0.77 }
							}
							else = {
								check_variable = { cons_prog = 0.79 }
							}
						}
						else = {
							if = { limit = { construction_progress = 0.20 }
								check_variable = { cons_prog = 0.80 }
							}
							else = {
								check_variable = { cons_prog = 0.82 }
							}
						}
					}
					else = {
						if = { limit = { construction_progress = 0.15 }
							if = { limit = { construction_progress = 0.17 }
								check_variable = { cons_prog = 0.83 }
							}
							else = {
								check_variable = { cons_prog = 0.85 }
							}
						}
						else = {
							if = { limit = { construction_progress = 0.14 }
								check_variable = { cons_prog = 0.86 }
							}
							else = {
								check_variable = { cons_prog = 0.88 }
							}
						}
					}
				}
				else = {
					if = { limit = { construction_progress = 0.06 }
						if = { limit = { construction_progress = 0.09 }
							if = { limit = { construction_progress = 0.10 }
								check_variable = { cons_prog = 0.90 }
							}
							else = {
								check_variable = { cons_prog = 0.91 }
							}
						}
						else = {
							if = { limit = { construction_progress = 0.07 }
								check_variable = { cons_prog = 0.93 }
							}
							else = {
								check_variable = { cons_prog = 0.94 }
							}
						}
					}
					else = {
						if = { limit = { construction_progress = 0.03 }
							if = { limit = { construction_progress = 0.04 }
								check_variable = { cons_prog = 0.96 }
							}
							else = {
								check_variable = { cons_prog = 0.97 }
							}
						}
						else = {
							if = { limit = { construction_progress = 0.01 }
								check_variable = { cons_prog = 0.99 }
							}
							else = {
								check_variable = { cons_prog = 1.00 }
							}
						}
					}
				}
			}
		}
		#variable_arithmetic_trigger = {
		#	export_to_variable = {
		#		which = cProgress
		#		value = trigger_value:construction_progress
		#	}
		#	change_variable = {
		#		which = cProgress
		#		which = cons_prog
		#	}
		#	check_variable = {
		#		cProgress = 1
		#	}
		#}
	}
	
	option = {
        name = diggy.118.a
		
		cancel_construction = yes
		dig_rebate = yes
		add_building = digging_deeper
	}
}

#Culture Shift Events
province_event = {
	id = diggy.119
	title = diggy.119.t
	desc = {
		trigger = { province_id = 4119 }
		desc = diggy.119.daa
	}
	desc = {
		trigger = { province_id = 4208 }
		desc = diggy.119.dab
	}
	desc = {
		trigger = { province_id = 4020 }
		desc = diggy.119.dac
	}
	desc = {
		trigger = { province_id = 4147 }
		desc = diggy.119.dad
	}
	desc = {
		trigger = { province_id = 4236 }
		desc = diggy.119.dae
	}
	desc = {
		trigger = { province_id = 2931 }
		desc = diggy.119.daf
	}
	desc = {
		trigger = { province_id = 2863 }
		desc = diggy.119.dag
	}
	desc = {
		trigger = { province_id = 2868 }
		desc = diggy.119.dah
	}
	desc = {
		trigger = { province_id = 4056 }
		desc = diggy.119.dai
	}
	desc = {
		trigger = { province_id = 2963 }
		desc = diggy.119.daj
	}
	desc = {
		trigger = { province_id = 2942 }
		desc = diggy.119.dak
	}
	desc = {
		trigger = { province_id = 4238 }
		desc = diggy.119.dal
	}
	desc = {
		trigger = { province_id = 4100 }
		desc = diggy.119.dam
	}
	desc = {
		trigger = { province_id = 4217 }
		desc = diggy.119.dan
	}
	desc = {
		trigger = { province_id = 4078 }
		desc = diggy.119.dao
	}
	desc = {
		trigger = { province_id = 4039 }
		desc = diggy.119.dap
	}
	desc = {
		trigger = { province_id = 4218 }
		desc = diggy.119.daq
	}
	desc = {
		trigger = { province_id = 4265 }
		desc = diggy.119.dar
	}
	desc = {
		trigger = { province_id = 4284 }
		desc = diggy.119.das
	}
	desc = {
		trigger = { province_id = 4266 }
		desc = diggy.119.dat
	}
	desc = {
		trigger = { province_id = 4350 }
		desc = diggy.119.dau
	}
	desc = {
		trigger = { province_id = 4311 }
		desc = diggy.119.dav
	}
	desc = {
		trigger = { province_id = 4323 }
		desc = diggy.119.daw
	}
	desc = {
		trigger = { province_id = 4093 }
		desc = diggy.119.dax
	}
	desc = {
		trigger = { province_id = 2973 }
		desc = diggy.119.day
	}
	desc = {
		trigger = { province_id = 2914 }
		desc = diggy.119.daz
	}
	desc = {
		trigger = { province_id = 4247 }
		desc = diggy.119.dba
	}
	desc = {
		trigger = { province_id = 4124 }
		desc = diggy.119.dbb
	}
	picture = FORT_eventPicture
	
	mean_time_to_happen = {
		years = 30
		modifier = {
			factor = 1.5
			has_seat_in_parliament = yes #nobles/elite experience constant arguing for their hold's interests	#thpse represented in parliament are less likely to shift. those not represented will be more secessionist
		}
		
		modifier = {
			factor = 0.9
			has_dwarven_hold_6 = yes     #deeper/richer holds are more likely to develop new customs
		}
		modifier = {
			factor = 0.9
			has_dwarven_hold_7 = yes
		}
		modifier = {
			factor = 0.9
			has_dwarven_hold_8 = yes
		}
		modifier = {
			factor = 0.9
			has_dwarven_hold_9 = yes
		}
		modifier = {
			factor = 0.8
			has_dwarven_hold_10 = yes  #can't be passively dug, the grandest of the 'common' holds
		}
		modifier = {
			factor = 0.7
			has_dwarven_hold_11 = yes  #is one of a possible two greatest holds on the planet
		}
		
		modifier = {
			factor = 1.5
			any_neighbor_province = {
				OR = {
					has_province_modifier = restored_rail #more contact with outside
					has_province_modifier = advanced_rail
				}
			}
		}
		
		modifier = {                                #advanced rail in both this and previous modifier
			factor = 2                              #to prevent only upgrading some rail being better than repairing all
			any_neighbor_province = {
				has_province_modifier = advanced_rail #more contact with outside
			}
		}
		
		modifier = {                                 #advanced specialised infrastructure
			factor = 0.35                            #means it was a capital at one point, and more unique than the holds with tier 1 specialties
			OR = {
				has_province_modifier = hold_foundry_2
				has_province_modifier = hold_city_2
				has_province_modifier = hold_artisan_2
				has_province_modifier = hold_farm_2
				has_province_modifier = hold_military_2
			}
		}
		
		modifier = {                                 #unique wonder
			factor = 0.25                            #means it was a capital at one point, and has one of the five globally-unique wonders
			OR = {                                   #an easy point of pride and cultural specialisation
				has_province_modifier = magma_forge
				has_province_modifier = artificier_hall
				has_province_modifier = engineer_manufactory
				has_province_modifier = high_gardens
				has_province_modifier = military_academy
			}
		}
		
		modifier = {                                 #territories are much less involved with central government, more likely to split
			factor = 1.5
			is_state_core = owner
		}
		
		modifier = {                                 #stable country is more stable
			factor = 2
			owner = { stability = 3 }
		}
		
		modifier = {
			factor = 1.5
			owner = { stability = 1 }
		}
		
		modifier = {
			factor = 0.75
			owner = { NOT = { stability = 0 } }
		}
		
		modifier = {
			factor = 0.5
			owner = { NOT = { stability = -2 } }
		}
	}
	
	trigger = {								   #some checks could be exported somewhere else idk, I like them here because diggy.31 *and* the upgrade_hold scripted effect can fire it.
		culture_group = dwarven                #No free race swap
		NOT = { culture = obsidian_dwarf }     #Obsidian invasion is too angry to swap 
		OR = {                                 #Only when dug deep
			has_dwarven_hold_5 = yes
			AND = {								#AI digs slowly - possibly unnecessary
				owner = {
					ai = yes
				}
				has_dwarven_hold_3 = yes
			}
		}
		continent = serpentspine
		NOT = {
			province_id = 4122
			province_id = 4128
			province_id = 4149  #Amldihr child holds
			province_id = 4313  #Gronstunad child hold
			has_province_flag = dwarf_culture_emerging #let's not spam this
			province_has_historical_culture = yes      #or try to convert the existing correct culture
		}
		is_capital = no                                #am dum - capital should be too bound to existing administration/the court/ways of life for this event to happen
		
		NOT = { owner = { has_disaster = hoardcurse } }	#hoardcurse deals with this, just in case these want to fire (it should not!)
	}
	
	immediate = {
		set_province_flag = dwarf_culture_emerging
	}
	
	option = {
        name = diggy.119.a
		ai_chance = { factor = 100 }
		area = { 
			limit = { culture_group = dwarven } 
			set_province_historical_culture = yes
			add_local_autonomy = 10
		}
		add_province_modifier = { #harder to culture convert, autonomy grant
			name = diggy_autonomy_concessions
			duration = 7300
		}
	}
	
	#middle option was deprecated for not making much sense
	
	option = {
        name = diggy.119.c
		custom_tooltip = diggy_dangerous_path_tt
		ai_chance = { factor = 0 }
		area = { limit = { culture_group = dwarven } add_unrest = 5 set_province_historical_culture = yes }
		add_province_modifier = {
			name = diggy_suppressed_populace   #Much worse
			duration = 7300
		}
		add_province_modifier = {              #so you don't plan around using it close to expiry and then the next event hits
			name = diggy_cultural_integration_initiative
			duration = 1825
		}
		hidden_effect = { province_event = { id = diggy.120 days = 1825 random = 730 } }
	}
}

province_event = {
	id = diggy.120 							  #event forces an uprising on you because you were mean
	title = diggy.120.t                       
	desc = diggy.120.d                        
	picture = ANGRY_MOB_eventPicture

	
	is_triggered_only = yes
	
	trigger = {
		has_province_modifier = diggy_suppressed_populace
		culture_group = dwarven                #No free race swap, dwarves can't rise in nationalist revolt if you killed them
		continent = serpentspine         
	}
	
	immediate = {
		area = { limit = { culture_group = dwarven } add_devastation = 10 }
	}
	
	option = {
        name = diggy.120.a
		ai_chance = { factor = 100 }
		spawn_rebels = {
			type = nationalist_rebels
			size = 3
		}
		area = { 
			limit = { culture_group = dwarven }
			add_nationalism = 15
			spawn_rebels = {
				type = nationalist_rebels
				size = 1
			}
		}
	}
}

#remove on expanding outside
country_event = {
	id = diggy.121
	title = diggy.121.t
	desc = diggy.121.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		has_country_modifier = dwarovar_claimer
	}

	immediate = {
		remove_country_modifier = dwarovar_claimer
	}
	
	# welcome to the dwarovar. Send your tears to the discord.
	option = {
        name = diggy.121.a
        ai_chance = { factor = 10 }
	}
}

#remove on vassalized
country_event = {
	id = diggy.122
	title = diggy.122.t
	desc = diggy.122.d
	picture = FORT_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		has_country_modifier = dwarovar_claimer
	}

	immediate = {
		remove_country_modifier = dwarovar_claimer
	}
	
	# welcome to the dwarovar. Send your tears to the discord.
	option = {
        name = diggy.122.a
        ai_chance = { factor = 10 }
	}
}