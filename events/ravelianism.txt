namespace = ravelian

# ravelian.1-99 spawning events
# ravelian.101-199 random events for early stage
# ravelian.201-299 random events for after god fragment
# ravelian.301-399 random events for once they're a religion???
# first ravelian societies
province_event = {
	id = ravelian.1
	title = ravelian.1.t
	desc = { 
		trigger = { has_global_flag = ravelian_society_founded }
		desc = ravelian.1.da
	}
	desc = {
		trigger = { NOT = { has_global_flag = ravelian_society_founded } }
		desc = ravelian.1.db
	}
	picture = ENLIGHTENMENT_eventPicture
	
	trigger = {
		continent = europe
		NOT = { is_religion_enabled = ravelian }
		has_global_flag = crimson_deluge
	#	is_year = 1560
		development = 20
		religion_group = cannorian
		NOT = { has_province_modifier = ravelian_society }
		NOT = { has_province_flag = denied_ravelian_society }
		NOT = { has_province_modifier = ravelian_lodge }
	}
	
	mean_time_to_happen = {
		months = 480
		modifier = {
			factor = 0.8
			has_terrain = city_terrain
		}
		modifier = {
			factor = 0.8
			development = 30
		}
		modifier = {
			factor = 2.0
			religion = regent_court
		}
		modifier = {
			factor = 0.8
			has_institution = printing_press
		}
		modifier = {
			factor = 0.8
			province_id = 8
		}
		modifier = {
			factor = 0.8
			region = businor_region
		}
		modifier = {
			factor = 0.8
			has_global_flag = ravelian_society_founded
		}
	}

	immediate = {
		hidden_effect = {
			save_event_target_as = ravelian_province
		}
		set_global_flag = ravelian_society_founded
	}
	
	goto = ravelian_province

	#cool
	option = {
		name = "ravelian.1.a"
		ai_chance = {
			factor = 70
			modifier = {
				factor = 2
				innovativeness_ideas = 7
			}
			modifier = {
				factor = 1.1
				innovativeness_ideas = 1
			}
			modifier = {
				factor = 1.5
				humanist_ideas = 7
			}
			modifier = {
				factor = 1.1
				humanist_ideas = 1
			}
			modifier = {
				factor = 1.4
				is_lacking_institutions = yes
			}
		}
		add_permanent_province_modifier = {
			name = ravelian_society
			duration = -1
		}
	}
	#ban them
	option = {
		name = "ravelian.1.b"
		ai_chance = {
			factor = 30
			modifier = {
				factor = 2
				religious_ideas = 7
			}
			modifier = {
				factor = 1.2
				religious_ideas = 1
			}
		}
		set_province_flag = denied_ravelian_society
	}
}

# ravelian headquarters
province_event = {
	id = ravelian.2
	title = ravelian.2.t
	desc = ravelian.2.d
	picture = GREAT_BUILDING_eventPicture
	
	trigger = {
		has_province_modifier = ravelian_society
		NOT = { region_for_scope_province = { has_province_modifier = ravelian_lodge } }
		religion_group = cannorian
	}
	
	mean_time_to_happen = {
		months = 480
		modifier = {
			factor = 0.8
			has_terrain = city_terrain
		}
		modifier = {
			factor = 0.8
			development = 30
		}
		modifier = {
			factor = 0.8
			development = 40
		}
		modifier = {
			factor = 0.8
			province_id = 8
		}
		modifier = {
			factor = 0.8
			region = businor_region
		}
		modifier = {
			factor = 0.8
			NOT = {
				owner = {
					num_of_cities = 6
				}
			}
		}
		modifier = {
			factor = 0.5
			NOT = {
				owner = {
					num_of_cities = 6
				}
			}
			owner = {
				total_development = 100
			}
		}
	}
	#is_mtth_scaled_to_size = 1

	immediate = {
		hidden_effect = {
			save_event_target_as = ravelian_province
		}
	}
	
	goto = ravelian_province

	#cool
	option = {
		name = "ravelian.2.a"
		ai_chance = {
			factor = 70
			modifier = {
				factor = 2
				innovativeness_ideas = 7
			}
			modifier = {
				factor = 1.1
				innovativeness_ideas = 1
			}
			modifier = {
				factor = 1.5
				humanist_ideas = 7
			}
			modifier = {
				factor = 1.1
				humanist_ideas = 1
			}
			modifier = {
				factor = 1.4
				is_lacking_institutions = yes
			}
		}
		add_permanent_province_modifier = {
			name = ravelian_lodge
			duration = -1
		}
		remove_province_modifier = ravelian_society

		add_treasury = 100
	}
	#ban them
	option = {
		name = "ravelian.2.b"
		ai_chance = {
			factor = 30
			modifier = {
				factor = 2
				religious_ideas = 7
			}
			modifier = {
				factor = 1.2
				religious_ideas = 1
			}
		}

		OWNER = { add_prestige = -10 }
	}
}

#ravelian rectorate spawn - for small country
country_event = {
	id = ravelian.3
	title = ravelian.3.t
	desc = ravelian.3.d
	picture = RELIGIOUS_CONVERSION_eventPicture
	
	major = yes
	
	trigger = {
		capital_scope = {
			continent = europe
		}
		NOT = { is_religion_enabled = ravelian }
		has_global_flag = ravelianism_can_be_founded
		NOT = {
			num_of_cities = 6
		}
		religion_group = cannorian
		any_owned_province = {
			AND = {
				can_have_center_of_reformation_trigger = {
					RELIGION = ravelian
				}
				has_province_modifier = ravelian_lodge
			}
		}
		is_defender_of_faith = no
		NOT = { has_reform = papacy_reform }
		is_religion_enabled = corinite
		is_vassal = no
	}
	
	mean_time_to_happen = {
		months = 60
		
		modifier = {
			factor = 0.75
			ruler_has_personality = free_thinker_personality
		}
		modifier = {
			factor = 2
			ruler_has_personality = righteous_personality
		}
		modifier = {
			factor = 0.75
			ruler_has_personality = scholar_personality
		}
		
		modifier = {
			factor = 0.75
			AND = {
				NOT = { num_of_cities = 2 }	#city states
			}
		}
		
		modifier = {
			factor = 0.75
			religion = corinite
		}
		modifier = {
			factor = 0.5
			tag = A38
		}
		modifier = {
			factor = 0.5
			num_of_owned_provinces_with = {
				value = 1
				development = 30
			}
		}
		
		modifier = {
			factor = 0.5
			religion_years = { corinite = 125 }
		}
		modifier = {
			factor = 0.5
			religion_years = { corinite = 150 }
		}
		modifier = {
			factor = 0.9
			innovativeness_ideas = 5
		}
		modifier = {
			factor = 0.9
			innovativeness_ideas = 6
		}
		modifier = {
			factor = 0.9
			innovativeness_ideas = 7
		}
		modifier = {
			factor = 1.5
			NOT = { innovativeness_ideas = 3 }
		}
		modifier = {
			factor = 2
			NOT = { innovativeness_ideas = 2 }
		}
		modifier = {
			factor = 2
			NOT = { innovativeness_ideas = 1 }
		}
		modifier = {
			factor = 0.8
			has_idea = humanist_tolerance
		}	
		modifier = {
			factor = 0.5
			num_of_rebel_controlled_provinces = 1
		}
		modifier = {
			factor = 0.8
			total_development = 100
		}
	}
	
	option = {
		name = "ravelian.3.a"
		ai_chance = {
			factor = 70
		}
		enable_religion = ravelian
		change_religion = ravelian
		change_tag = Z97
		change_government = theocracy
		add_government_reform = papacy_reform
		add_curia_treasury = 1000
		random_owned_province = {
			limit = {
				can_have_center_of_reformation_trigger = {
					RELIGION = ravelian
				}
				has_province_modifier = ravelian_lodge
			}
			change_religion = ravelian
			add_reform_center = ravelian
			add_permanent_province_modifier = {
				name = "religious_zeal_at_conv"
				duration = 9000
			}
		}
		capital_scope = {
			change_religion = ravelian
			add_permanent_province_modifier = {
				name = "religious_zeal_at_conv"
				duration = 9000
			}
		}
		add_country_modifier = {
			name = "conversion_zeal"
			duration = 3650
		}
		if = {
			limit = {
				has_custom_ideas = no
				OR = {
					ai = no
					AND = {
						ai = yes
						has_idea_group = default_ideas
					}
				}
			}
			country_event = { id = ideagroups.1 } #Swap Ideas
		}
		every_owned_province = {
			limit = {
				has_province_modifier = ravelian_lodge
			}
			change_religion = ravelian
			add_permanent_province_modifier = {
				name = "religious_zeal_at_conv"
				duration = 9000
			}
			add_cardinal = yes
			remove_province_modifier = ravelian_lodge
		}
		every_owned_province = {
			limit = {
				has_province_modifier = ravelian_society
			}
			change_religion = ravelian
			add_permanent_province_modifier = {
				name = "religious_zeal_at_conv"
				duration = 9000
			}
			remove_province_modifier = ravelian_society
		}
		hidden_effect = {
			every_country = {
				limit = {
					capital_scope = { continent = europe }
					NOT = { tag = Z97 }
				}
				country_event = {
					id = ravelian.5 
				}
			}
		}
	}
	#no I don't want to go to ravelian state please nonononono
	option = {
		name = ravelian.3.b
		ai_chance = {
			factor = 0
		}
		hidden_effect = {
			random_known_country = {
				limit = {
					is_defender_of_faith = no
					religion_group = cannorian
					NOT = { has_reform = papacy_reform }
					capital_scope = {
						continent = europe
					}
					NOT = {
						num_of_cities = 6
					}
					any_owned_province = {
						AND = {
							can_have_center_of_reformation_trigger = {
								RELIGION = ravelian
							}
							has_province_modifier = ravelian_lodge
						}
					}
				}
				country_event = {
					id = ravelian.3
					days = 30
				}
			}
		}
	}
}

#ravelian rectorate spawn if no small countries own a headquarters
country_event = {
	id = ravelian.4
	title = ravelian.4.t
	desc = ravelian.4.d
	picture = RELIGIOUS_CONVERSION_eventPicture

	trigger = {
		NOT = { is_religion_enabled = ravelian }
		has_global_flag = ravelianism_can_be_founded
		capital_scope = {
			continent = europe
		}
		religion_group = cannorian
		num_of_cities = 6
		any_owned_province = {
			AND = {
				can_have_center_of_reformation_trigger = {
					RELIGION = ravelian
				}
				has_province_modifier = ravelian_lodge
				NOT = { is_capital = yes }
			}
		}
		is_defender_of_faith = no
		NOT = { has_reform = papacy_reform }
		is_religion_enabled = corinite
		is_vassal = no
	}
	
	mean_time_to_happen = {
		months = 120
		modifier = {
			factor = 0.75
			ruler_has_personality = free_thinker_personality
		}
		modifier = {
			factor = 2
			ruler_has_personality = righteous_personality
		}
		modifier = {
			factor = 0.75
			ruler_has_personality = scholar_personality
		}
		modifier = {
			factor = 0.75
			religion = corinite
		}
		modifier = {
			factor = 0.5
			tag = A38
		}
		modifier = {
			factor = 0.75
			num_of_owned_provinces_with = {
				value = 1
				development = 30
			}
		}
		modifier = {
			factor = 0.5
			religion_years = { corinite = 125 }
		}
		modifier = {
			factor = 0.5
			religion_years = { corinite = 150 }
		}
		modifier = {
			factor = 0.9
			innovativeness_ideas = 5
		}
		modifier = {
			factor = 0.9
			innovativeness_ideas = 6
		}
		modifier = {
			factor = 0.9
			innovativeness_ideas = 7
		}
		modifier = {
			factor = 1.5
			NOT = { innovativeness_ideas = 3 }
		}
		modifier = {
			factor = 2
			NOT = { innovativeness_ideas = 2 }
		}
		modifier = {
			factor = 2
			NOT = { innovativeness_ideas = 1 }
		}
		modifier = {
			factor = 0.8
			has_idea = humanist_tolerance
		}
		modifier = {
			factor = 0.5
			num_of_rebel_controlled_provinces = 1
		}
	}
	
	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = {
					has_province_modifier = ravelian_lodge
					NOT = { is_capital = yes }
				}
				save_event_target_as = ravelian_province
			}
		}
	}
	goto = ravelian_province
	
	#join them
	option = {
		name = ravelian.4.a
		ai_chance = {
			factor = 70
			#modifier = {
			#	factor = 10
			#	has_personal_deity = adean
			#}
		}
		hidden_effect = {
			enable_religion = ravelian
			event_target:ravelian_province = {
				add_core = Z97
				area = {
					limit = { is_capital = no }
					add_core = Z97
				}
				change_religion = ravelian
				add_permanent_province_modifier = {
					name = "religious_zeal_at_conv"
					duration = 9000
				}
				add_reform_center = ravelian
				add_cardinal = yes
			}
			release = Z97
			Z97 = {
				change_religion = ravelian
				change_government = theocracy
				add_government_reform = papacy_reform
				add_treasury = 1000
				add_curia_treasury = 1000
				add_dip_power = 500
				add_mil_power = 500
				add_adm_power = 500
				add_idea_group = innovativeness_ideas
				add_idea = formalized_officer_corps
				build_to_forcelimit = {
					infantry = 0.6
					cavalry = 0.1
					artillery = 0.3
				}
				change_primary_culture = event_target:ravelian_province
				set_ruler_culture = event_target:ravelian_province
				set_ruler_religion = ravelian
				capital_scope = {
					change_religion = ravelian
					add_permanent_province_modifier = {
						name = "religious_zeal_at_conv"
						duration = 9000
					}
				}
				add_country_modifier = {
					name = "conversion_zeal"
					duration = 3650
				}
				every_owned_province = {
					limit = {
						has_province_modifier = ravelian_lodge
					}
					change_religion = ravelian
					add_permanent_province_modifier = {
						name = "religious_zeal_at_conv"
						duration = 9000
					}
					add_cardinal = yes
					remove_province_modifier = ravelian_lodge
				}
				every_owned_province = {
					limit = {
						has_province_modifier = ravelian_society
					}
					change_religion = ravelian
					add_permanent_province_modifier = {
						name = "religious_zeal_at_conv"
						duration = 9000
					}
					remove_province_modifier = ravelian_society
				}
			}
			every_country = {
				limit = {
					capital_scope = { continent = europe }
					NOT = { tag = Z97 }
					NOT = { tag = ROOT }
				}
				country_event = {
					id = ravelian.5 
				}
			}
		}
		change_religion = ravelian
		add_treasury = 500
		add_papal_influence = 100
		random_owned_province = {
			limit = {
				can_have_center_of_reformation_trigger = {
					RELIGION = ravelian
				}
				has_province_modifier = ravelian_lodge
			}
			change_religion = ravelian
			add_reform_center = ravelian
			add_cardinal = yes
			add_permanent_province_modifier = {
				name = "religious_zeal_at_conv"
				duration = 9000
			}
		}
		capital_scope = {
			change_religion = ravelian
			add_permanent_province_modifier = {
				name = "religious_zeal_at_conv"
				duration = 9000
			}
			add_cardinal = yes
		}
		add_country_modifier = {
			name = "conversion_zeal"
			duration = 3650
		}
	}
	#don't convert give all your land conversion resistance as you're essentially letting them all go there
	option = {
		name = ravelian.4.b
		ai_chance = {
			factor = 30
			#modifier = {
			#	factor = 10
			#	has_personal_deity = adean
			#}
		}
		add_country_modifier = {
			name = ravelian_removed_ravelians
			duration = 14600 #40 years
		}

		add_stability = -1

		hidden_effect = {
			event_target:ravelian_province = {
				add_core = Z97
				area = {
					limit = { is_capital = no }
					add_core = Z97
				}
				change_religion = ravelian
				add_permanent_province_modifier = {
					name = "religious_zeal_at_conv"
					duration = 9000
				}
				add_reform_center = ravelian
				add_cardinal = yes
			}
			release = Z97
			enable_religion = ravelian
			Z97 = {
				change_religion = ravelian
				change_government = theocracy
				add_government_reform = papacy_reform
				add_treasury = 1000
				add_curia_treasury = 1000
				add_dip_power = 400
				add_mil_power = 400
				add_adm_power = 400
				add_idea_group = innovativeness_ideas
				add_idea = formalized_officer_corps
				change_primary_culture = event_target:ravelian_province
				set_ruler_culture = event_target:ravelian_province
				set_ruler_religion = ravelian
				capital_scope = {
					change_religion = ravelian
					add_permanent_province_modifier = {
						name = "religious_zeal_at_conv"
						duration = 9000
					}
				}
				add_country_modifier = {
					name = "conversion_zeal"
					duration = 3650
				}
				every_owned_province = {
					limit = {
						has_province_modifier = ravelian_lodge
					}
					change_religion = ravelian
					add_permanent_province_modifier = {
						name = "religious_zeal_at_conv"
						duration = 9000
					}
					add_cardinal = yes
					remove_province_modifier = ravelian_lodge
				}
				every_owned_province = {
					limit = {
						has_province_modifier = ravelian_society
					}
					change_religion = ravelian
					add_permanent_province_modifier = {
						name = "religious_zeal_at_conv"
						duration = 9000
					}
					remove_province_modifier = ravelian_society
				}
			}
			#extra bonus the AI gets if you're not converting
			Z97 = {
				add_treasury = 2000
				add_dip_power = 400
				add_mil_power = 400
				add_adm_power = 400
				add_manpower = 20
			}
		}
		every_owned_province = {
			remove_province_modifier = ravelian_society
			remove_province_modifier = ravelian_lodge
		}
		hidden_effect = {
			every_country = {
				limit = {
					capital_scope = { continent = europe }
					NOT = { tag = Z97 }
					NOT = { tag = ROOT }
				}
				country_event = {
					id = ravelian.5 
				}
			}
		}
	}
	#play as them
	option = {
		name = ravelian.4.c
		ai_chance = {
			factor = 0
		}
		hidden_effect = {
			change_religion = ravelian
			add_treasury = 500
			add_papal_influence = 100
			random_owned_province = {
				limit = {
					can_have_center_of_reformation_trigger = {
						RELIGION = ravelian
					}
					has_province_modifier = ravelian_lodge
				}
				change_religion = ravelian
				add_reform_center = ravelian
				add_cardinal = yes
				add_permanent_province_modifier = {
					name = "religious_zeal_at_conv"
					duration = 9000
				}
			}
			capital_scope = {
				change_religion = ravelian
				add_permanent_province_modifier = {
					name = "religious_zeal_at_conv"
					duration = 9000
				}
				add_cardinal = yes
			}
			add_country_modifier = {
				name = "conversion_zeal"
				duration = 3650
			}
			event_target:ravelian_province = {
				add_core = Z97
				area = {
					limit = { is_capital = no }
					add_core = Z97
				}
				change_religion = ravelian
				add_permanent_province_modifier = {
					name = "religious_zeal_at_conv"
					duration = 9000
				}
				add_reform_center = ravelian
				add_cardinal = yes
			}
			release = Z97
			enable_religion = ravelian
			Z97 = {
				change_religion = ravelian
				change_government = theocracy
				add_government_reform = papacy_reform
				add_treasury = 1000
				add_curia_treasury = 1000
				add_dip_power = 400
				add_mil_power = 400
				add_adm_power = 400
				add_idea_group = innovativeness_ideas
				add_idea = formalized_officer_corps
				change_primary_culture = event_target:ravelian_province
				set_ruler_culture = event_target:ravelian_province
				set_ruler_religion = ravelian
				capital_scope = {
					change_religion = ravelian
					add_permanent_province_modifier = {
						name = "religious_zeal_at_conv"
						duration = 9000
					}
				}
				add_country_modifier = {
					name = "conversion_zeal"
					duration = 3650
				}
				every_owned_province = {
					limit = {
						has_province_modifier = ravelian_lodge
					}
					change_religion = ravelian
					add_permanent_province_modifier = {
						name = "religious_zeal_at_conv"
						duration = 9000
					}
					add_cardinal = yes
					remove_province_modifier = ravelian_lodge
				}
				every_owned_province = {
					limit = {
						has_province_modifier = ravelian_society
					}
					change_religion = ravelian
					add_permanent_province_modifier = {
						name = "religious_zeal_at_conv"
						duration = 9000
					}
					remove_province_modifier = ravelian_society
				}
			}
			every_country = {
				limit = {
					capital_scope = { continent = europe }
					NOT = { tag = Z97 }
				}
				country_event = {
					id = ravelian.5 
				}
			}
		}
		switch_tag = Z97
	}
	#no go away
	option = {
		name = ravelian.4.e
		ai_chance = {
			factor = 0
		}

		add_stability = -1

		hidden_effect = {
			random_known_country = {
				limit = {
					religion_group = cannorian
					num_of_cities = 6
					capital_scope = { continent = europe }
					any_owned_province = {
						AND = {
							can_have_center_of_reformation_trigger = {
								RELIGION = ravelian
							}
							has_province_modifier = ravelian_lodge
						}
					}
				}
				country_event = {
					id = ravelian.4
					days = 30
				}
			}
		}
	}
}


country_event = {
	id = ravelian.5
	title = ravelian.5.t
	desc = ravelian.5.d
	picture = RELIGION_eventPicture
	
	is_triggered_only = yes
	mean_time_to_happen = { days = 1 }
	trigger = {
		#OR = {
		#	any_owned_province = { has_province_modifier = ravelian_society }
		#	any_owned_province = { has_province_modifier = ravelian_lodge }
		#}

	}
	
	#convert
	option = {
		name = ravelian.5.a
		trigger = {
			OR = {
				any_owned_province = {
					has_province_modifier = ravelian_society
				}
				any_owned_province = {
					has_province_modifier = ravelian_lodge
				}
			}
		}
		ai_chance = {
			factor = 20
			modifier = {
				factor = 2
				any_owned_province = {
					has_province_modifier = ravelian_lodge
				}
			}
			modifier = {
				factor = 2
				innovativeness_ideas = 7
			}
			modifier = {
				factor = 1.1
				innovativeness_ideas = 1
			}
			modifier = {
				factor = 1.5
				humanist_ideas = 7
			}
			modifier = {
				factor = 1.1
				humanist_ideas = 1
			}
			modifier = {
				factor = 0.1
				NOT = {
					religion_group = cannorian
				}
			}
			modifier = {
				factor = 0
				has_country_modifier = monstrous_nation
			}
			modifier = {
				factor = 0.1 #countries dedicated to one regent court god are unlikely to convert
				OR = {
					tag = B02
					tag = A10
					tag = A41
					tag = A43
					tag = A53
				}
			}
		}
		change_religion = ravelian
		add_country_modifier = {
			name = "conversion_zeal"
			duration = 3650
		}
		capital_scope = {
			change_religion = ravelian
			add_permanent_province_modifier = {
				name = "religious_zeal_at_conv"
				duration = 9000
			}
		}
		random_owned_province = {
			limit = {
				can_have_center_of_reformation_trigger = {
					RELIGION = ravelian
				}
				has_province_modifier = ravelian_lodge
			}
			change_religion = ravelian
			add_reform_center = ravelian
			add_cardinal = yes
			add_permanent_province_modifier = {
				name = "religious_zeal_at_conv"
				duration = 9000
			}
		}
		every_owned_province = {
			limit = {
				has_province_modifier = ravelian_lodge
			}
			change_religion = ravelian
			add_permanent_province_modifier = {
				name = "religious_zeal_at_conv"
				duration = 9000
			}
			add_cardinal = yes
			remove_province_modifier = ravelian_lodge
		}
		every_owned_province = {
			limit = {
				has_province_modifier = ravelian_society
			}
			change_religion = ravelian
			add_permanent_province_modifier = {
				name = "religious_zeal_at_conv"
				duration = 9000
			}
			remove_province_modifier = ravelian_society
		}
	}
	#don't convert
	option = {
		name = ravelian.5.b
		ai_chance = {
			factor = 70
			modifier = {
				factor = 1.5
				has_personal_deity = adean
			}
		}
		random_owned_province = {
			limit = {
				can_have_center_of_reformation_trigger = {
					RELIGION = ravelian
				}
				has_province_modifier = ravelian_lodge
			}
			change_religion = ravelian
			add_reform_center = ravelian
			#add_cardinal = yes	#shouldnt actually cos you arent converting
			add_permanent_province_modifier = {
				name = "religious_zeal_at_conv"
				duration = 9000
			}
		}
		every_owned_province = {
			limit = {
				has_province_modifier = ravelian_lodge
			}
			change_religion = ravelian
			add_permanent_province_modifier = {
				name = "religious_zeal_at_conv"
					duration = 9000
				}
			#add_cardinal = yes
			remove_province_modifier = ravelian_lodge
		}
		every_owned_province = {
			limit = {
				has_province_modifier = ravelian_society
			}
			change_religion = ravelian
			add_permanent_province_modifier = {
				name = "religious_zeal_at_conv"
				duration = 9000
			}
			remove_province_modifier = ravelian_society
		}
	}
}

#god fragment has been found and they want it
country_event = {
	id = ravelian.6
	title = ravelian.6.t
	desc = { 
		trigger = { has_country_flag = pf_end_god_fragment_ruin_flag }
		desc = ravelian.6.da
	}
	desc = {
		trigger = { NOT = { has_country_flag = pf_end_god_fragment_ruin_flag } }
		desc = ravelian.6.db
	}
	picture = wihgfx_FEMALE_SCHOLAR_eventPicture
	
	trigger = {
		NOT = { has_global_flag = ravelians_have_god_fragment }
		has_global_flag = ravelian_society_founded
		NOT = { is_religion_enabled = ravelian }
		OR = {
			any_owned_province = { has_province_modifier = god_fragment_ruins }
			any_subject_country = {
				any_owned_province = { has_province_modifier = god_fragment_ruins }
			}
		}
	}
	
	mean_time_to_happen = {
		months = 120
	}
	#allow it
	option = {
		ai_chance = {
			factor = 70
			#modifier = {
			#	factor = 10
			#	has_personal_deity = adean
			#}
		}
		name = "ravelian.6.a"
		#set_global_flag = ravelians_have_god_fragment
		set_country_flag = ravelianism_let_mage_take_fragment

		add_prestige = 10

		#TODO: add custom tooltip
	}
	#disallow it
	option = {
		ai_chance = {
			factor = 70
			#modifier = {
			#	factor = 10
			#	has_personal_deity = adean
			#}
		}
		name = "ravelian.6.b"
		hidden_effect = {
			country_event = {
				id = ravelian.7 
				days = 50
				random = 20
			}
		}
	}
}

#researcher takes it anyway
country_event = {
	id = ravelian.7
	title = ravelian.7.t
	desc = ravelian.7.d
	picture = wihgfx_FEMALE_SCHOLAR_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { is_religion_enabled = ravelian }
	}

	#
	option = {
		name = "ravelian.7.a"
		#set_global_flag = ravelians_have_god_fragment
		add_prestige = -10
	}
}

#society has god fragment announcement
country_event = {
	id = ravelian.8
	title = ravelian.8.t
	desc = {
		trigger = { has_country_flag = ravelianism_let_mage_take_fragment }
		desc = ravelian.8.da
	}
	desc = {
		trigger = {
			NOT = { has_country_flag = ravelianism_let_mage_take_fragment }
			has_country_flag = pf_end_god_fragment_ruin_flag
		}
		desc = ravelian.8.db
	}
	desc = {
		trigger = { NOT = { has_country_flag = pf_end_god_fragment_ruin_flag } }
		desc = ravelian.8.dc
	}
	picture = POPE_PREACHING_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		is_year = 1600
		NOT = { has_global_flag = ravelians_have_god_fragment }
		has_global_flag = ravelian_society_founded
		capital_scope = {
			continent = europe
		}
		OR = {
			any_owned_province = { has_province_modifier = ravelian_society }
			any_owned_province = { has_province_modifier = ravelian_lodge }
		}
	}
	
	#is_triggered_only = yes
	#mean_time_to_happen = {
	#	months = 12
	#}
	
	option = {
		name = "ravelian.8.a"
		set_global_flag = ravelians_have_god_fragment
		set_global_flag = pf_end_god_fragment_ruin_flag_global

		if = {
			limit = { has_country_flag = ravelianism_let_mage_take_fragment }
			add_prestige = 20
		}

		hidden_effect = {
			country_event = {
				id = ravelian.10
				days = 7300
			}
			every_country = {
				limit = {
					capital_scope = { continent = europe }
				}
				country_event = {
					id = ravelian.9
				}
			}
		}
	}
}

#copy of the event to tell the rest of cannor about it
country_event = {
	id = ravelian.9
	title = ravelian.8.t
	desc = {
		trigger = { has_country_flag = ravelianism_let_mage_take_fragment }
		desc = ravelian.8.da
	}
	desc = {
		trigger = {
			NOT = { has_country_flag = ravelianism_let_mage_take_fragment }
			has_country_flag = pf_end_god_fragment_ruin_flag
		}
		desc = ravelian.8.db
	}
	desc = {
		trigger = { NOT = { has_country_flag = pf_end_god_fragment_ruin_flag } }
		desc = ravelian.8.dc
	}
	picture = POPE_PREACHING_eventPicture
	
	trigger = {
		capital_scope = {
			continent = europe
		}
		OR = {
			any_owned_province = { has_province_modifier = ravelian_society }
			any_owned_province = { has_province_modifier = ravelian_lodge }
		}
	}
	
	is_triggered_only = yes
	
	#mean_time_to_happen = {
	#	months = 12
	#}
	
	option = {
		name = "ravelian.8.a"
		set_global_flag = ravelians_have_god_fragment
		set_global_flag = pf_end_god_fragment_ruin_flag_global
		hidden_effect = {
			country_event = {
				id = ravelian.10
				days = 7300
			}
		}
	}
}

#20 years has passed since the god fragment was taken, now the religion can be founded. Hidden event to enable the religion founding
country_event = {
	id = ravelian.10
	title = ravelian.10.t
	desc = ravelian.10.d
	picture = EXPLORERS_eventPicture
	
	#trigger = {
	#	is_year = 1600
	#}
	hidden = yes
	is_triggered_only = yes
	#mean_time_to_happen = {
	#	months = 12
	#}
	
	option = {
		name = "ravelian.10.a"
		set_global_flag = ravelianism_can_be_founded
	}
}

#start council event.
country_event = {
	id = ravelian.11
	title = ravelian.11.t
	desc = { 
		trigger = { has_global_flag = third_ravelian_council }
		desc = ravelian.11.dd
	}
	desc = {
		trigger = { has_global_flag = second_ravelian_council }
		desc = ravelian.11.dc
	}
	desc = { 
		trigger = { has_global_flag = first_ravelian_council }
		desc = ravelian.11.db
	}
	desc = {
		trigger = { NOT = { has_global_flag = first_ravelian_council } }
		desc = ravelian.11.da
	}

	picture = {
		trigger = { has_dlc = "American Dream" }
		picture = CONSTITUTION_eventPicture
	}
	picture = {
		trigger = { NOT = { has_dlc = "American Dream" } }
		picture = ENLIGHTENMENT_eventPicture
	}

	trigger = {
		reform_desire = 1
		tag = Z97
	}
	#is_triggered_only = yes

	option = {
		name = "ravelian.11.a"
		if = {
			set_global_flag = ravelian_council_active
			limit = {
				has_dlc = "Emperor"
			}
			enable_council = yes
			add_curia_treasury = 100000
			add_reform_desire = -1
			country_event = {
				id = ravelian.12
				days = 365
			}
			hidden_effect = {
				every_known_country = {
					limit = {
						religion = ravelian
					}
					country_event = {
						id = ravelian.13
					}
				}
			}
		}
	}
}

#end council event.
country_event = {
	id = ravelian.12
	title = ravelian.12.t
	desc = { 
		trigger = { has_global_flag = third_ravelian_council }
		desc = ravelian.12.dd
	}
	desc = {
		trigger = { has_global_flag = second_ravelian_council }
		desc = ravelian.12.dc
	}
	desc = { 
		trigger = { has_global_flag = first_ravelian_council }
		desc = ravelian.12.db
	}
	desc = {
		trigger = { NOT = { has_global_flag = first_ravelian_council } }
		desc = ravelian.12.da
	}

	picture = {
		trigger = { has_dlc = "American Dream" }
		picture = CONSTITUTION_eventPicture
	}
	picture = {
		trigger = { NOT = { has_dlc = "American Dream" } }
		picture = ENLIGHTENMENT_eventPicture
	}

	is_triggered_only = yes

	#
	option = {
		name = "ravelian.12.a"
		enable_council = no
		hidden_effect = {
			every_country = {
				limit = {
					religion = ravelian
					NOT = { tag = Z97}
				}
				country_event = {
					id = ravelian.14
				}
			}
		}
		if = {
			limit = { has_global_flag = third_ravelian_council }
			set_global_flag = fourth_ravelian_council
		}
		if = {
			limit = { has_global_flag = second_ravelian_council }
			set_global_flag = third_ravelian_council
		}
		if = {
			limit = { has_global_flag = first_ravelian_council }
			set_global_flag = second_ravelian_council
		}
		set_global_flag = first_ravelian_council
		clr_global_flag = ravelian_council_active
		#so these flags mean that those councils have happened and are finished. fourth_ravelian_council means all the councils are finished.
	}
}

#tell countries about it
country_event = {
	id = ravelian.13
	title = ravelian.11.t
	desc = { 
		trigger = { 
			has_global_flag = third_ravelian_council
			num_of_cardinals = 1
		}
		desc = ravelian.11.dda
	}
	desc = {
		trigger = { 
			has_global_flag = second_ravelian_council
			num_of_cardinals = 1
		}
		desc = ravelian.11.dca
	}
	desc = { 
		trigger = { 
			has_global_flag = first_ravelian_council
			num_of_cardinals = 1
		}
		desc = ravelian.11.dba
	}
	desc = {
		trigger = { 
			NOT = { has_global_flag = first_ravelian_council }
			num_of_cardinals = 1
		}
		desc = ravelian.11.daa
	}
	desc = { 
		trigger = { has_global_flag = third_ravelian_council }
		desc = ravelian.11.ddb
	}
	desc = {
		trigger = { has_global_flag = second_ravelian_council }
		desc = ravelian.11.dcb
	}
	desc = { 
		trigger = { has_global_flag = first_ravelian_council }
		desc = ravelian.11.dbb
	}
	desc = {
		trigger = { NOT = { has_global_flag = first_ravelian_council } }
		desc = ravelian.11.dab
	}

	picture = {
		trigger = { has_dlc = "American Dream" }
		picture = CONSTITUTION_eventPicture
	}
	picture = {
		trigger = { NOT = { has_dlc = "American Dream" } }
		picture = ENLIGHTENMENT_eventPicture
	}

	trigger = {
		always = yes
	}
	is_triggered_only = yes

	option = {
		name = "ravelian.13.a"

		trigger = { 
			num_of_cardinals = 1
		}

		tooltip = {
			if = {
				set_global_flag = ravelian_council_active
				limit = {
					has_dlc = "Emperor"
				}
				enable_council = yes
				add_curia_treasury = 100000
				add_reform_desire = -1
				country_event = {
					id = ravelian.12
					days = 365
				}
			}
		}
	}

	option = {
		name = "ravelian.13.b"

		trigger = { 
			NOT = { num_of_cardinals = 1 }
		}

		
		tooltip = {
			if = {
				set_global_flag = ravelian_council_active
				limit = {
					has_dlc = "Emperor"
				}
				enable_council = yes
				add_curia_treasury = 100000
				add_reform_desire = -1
				country_event = {
					id = ravelian.12
					days = 365
				}
			}
		}
	}
}

#tell other countries about it ending
country_event = {
	id = ravelian.14
	title = ravelian.12.t
	desc = { 
		trigger = { has_global_flag = third_ravelian_council }
		desc = ravelian.12.dd
	}
	desc = {
		trigger = { has_global_flag = second_ravelian_council }
		desc = ravelian.12.dc
	}
	desc = { 
		trigger = { has_global_flag = first_ravelian_council }
		desc = ravelian.12.db
	}
	desc = {
		trigger = { NOT = { has_global_flag = first_ravelian_council } }
		desc = ravelian.12.da
	}
	picture = {
		trigger = { has_dlc = "American Dream" }
		picture = CONSTITUTION_eventPicture
	}
	picture = {
		trigger = { NOT = { has_dlc = "American Dream" } }
		picture = ENLIGHTENMENT_eventPicture
	}

	trigger = {
		religion = ravelian
	}
	is_triggered_only = yes

	#
	option = {
		name = "ravelian.12.a"

		tooltip = {
			enable_council = no
			if = {
				limit = { has_global_flag = third_ravelian_council }
				set_global_flag = fourth_ravelian_council
			}
			if = {
				limit = { has_global_flag = second_ravelian_council }
				set_global_flag = third_ravelian_council
			}
			if = {
				limit = { has_global_flag = first_ravelian_council }
				set_global_flag = second_ravelian_council
			}
			set_global_flag = first_ravelian_council
			clr_global_flag = ravelian_council_active
			#so these flags mean that those councils have happened and are finished. fourth_ravelian_council means all the councils are finished.
		}
		}
	}
}

#naming this 21 because it's separate from the rest of this. 
province_event = {
	id = ravelian.21
	title = ravelian.21.t
	desc = ravelian.21.d
	picture = BIG_BOOK_eventPicture
	
	is_triggered_only = yes
	
	mean_time_to_happen = {
		months = 1
	}

	immediate = {
		hidden_effect = {
			save_event_target_as = ravelian_province
		}
	}
	goto = ravelian_province

	option = {
		name = "ravelian.21.a"
		remove_province_modifier = ravelian_society
		remove_province_modifier = ravelian_lodge
	}
}

#==============================================random event category one: generic ravelian society, always available for societies========================================

#ideas:
# Maybe a scholar approaches the crown for funding his attempts to translate traditionally very-erudite elven texts into the vernacular?
# Choice between a small gold cost and one-time MP gain, a larger gold cost and a province modifier for +institution spread or +Enlightenment specifically, or deny him the funding, which either does nothing or gives a token +1 unrest to the province?
country_event = {
	id = ravelian.101
	title = ravelian.101.t
	desc = ravelian.101.d
	picture = BIG_BOOK_eventPicture
	
	trigger = {
		#NOT = { has_global_flag = ravelians_have_god_fragment }
		NOT = { is_religion_enabled = ravelian }
		has_global_flag = ravelian_society_founded
		capital_scope = {
			continent = europe
		}
		any_owned_province = {
			has_province_modifier = ravelian_society
		}
	}
	
	mean_time_to_happen = {
		months = 1000
		
		modifier = {
			factor = 0.8
			ruler_has_personality = free_thinker_personality
		}
		modifier = {
			factor = 0.8
			ruler_has_personality = scholar_personality
		}
		modifier = {
			factor = 0.7
			innovativeness_ideas = 7
		}
	}
	
	#pay for translation
	option = {
		name = "ravelian.101.a"
		ai_chance = {
			factor = 70
			modifier = {
				factor = 0
				NOT = { treasury = 100 }
			}
		}
		add_treasury = -100
		add_prestige = 5
		random_list = {
			33 = {
				add_adm_power = 20
			}
			33 = {
				add_dip_power = 20
			}
			33 = {
				add_mil_power = 20
			}
		}
	}
	#don't pay
	option = {
		name = ravelian.101.b
		ai_chance = {
			factor = 30
		}
		add_prestige = -2
	}
}

#ravelian scholar educates heir
country_event = {
	id = ravelian.102
	title = ravelian.102.t
	desc = ravelian.102.d
	picture = BIG_BOOK_eventPicture
	
	trigger = {
		#NOT = { has_global_flag = ravelians_have_god_fragment }
		NOT = { is_religion_enabled = ravelian }
		has_global_flag = ravelian_society_founded
		capital_scope = {
			continent = europe
		}
		has_heir = yes
		heir_age = 15
        NOT = { heir_has_personality = scholar_personality }
		any_owned_province = {
			has_province_modifier = ravelian_society
		}
	}
	
	mean_time_to_happen = {
		months = 1000
		
		modifier = {
			factor = 0.8
			ruler_has_personality = free_thinker_personality
		}
		modifier = {
			factor = 0.8
			ruler_has_personality = scholar_personality
		}
		modifier = {
			factor = 0.7
			innovativeness_ideas = 7
		}
	}
	
	#yes
	option = {
		name = "ravelian.102.a"
		ai_chance = {
			factor = 70
			modifier = {
				factor = 0
				NOT = { treasury = 100 }
			}
		}
		add_treasury = -100
		random_list = {
			33 = {
				add_heir_adm = 1
			}
			33 = {
				add_heir_mil = 1
			}
			33 = {
				add_heir_dip = 1
			}
		}
		add_heir_personality = scholar_personality
	}
	#no
	option = {
		name = ravelian.102.b
		ai_chance = {
			factor = 30
		}
	}

	add_prestige = 1
}


#Novel Findings - amusing discoveries shared /w court

#Literacy Classes - they teach people how to read and write (cool - +production)

#Ravelians Invest in province (cool - +random dev?)

#Ravelian Artificers (cool - +production)

#Ravelians Argue /w Clergy Estate

#Ravelians Undermine Monarch if they're dumb and not woke





#==========================================random event category 2: post god fragment=============================================

#Ravelian... Preacher? - there's a weird scholarly debate but they are more like a priest for some reason, but the people seem happy (cool - revolt risk decrease)

#Ravelian Soup Kitchen - they feeding the poor (cool - +manpower)

#Public Sphere Debate - aka a bunch of commoners and ravelians talking about society (hmm woke I suppose - +prestige?)




#ideas

#An event which can happened if you own a province with accepted culture but wrong religion, where Ravellian ideas create some sort of local syncretism, reducing unrest for x years


#ideas for converting aelantir
#spawning societies in aelantir?
#propagate through trade?
#

#==========================================random event category 3: generic reform events=============================================

country_event = {
	id = ravelian.301
	title = ravelian.301.t
	desc = ravelian.301.d
	picture = BIG_BOOK_eventPicture
	
	trigger = {
		religion = ravelian
		#num_of_cardinals = 1
		NOT = { has_global_flag = fourth_ravelian_council }
		NOT = { has_global_flag = ravelian_council_active }
		has_dlc = "Emperor"
	}
	
	mean_time_to_happen = {
		months = 1000
	}
	
	#yes
	option = {
		name = "ravelian.301.a"
		ai_chance = {
			factor = 70
			modifier = {
				factor = 0
				average_effective_unrest = 2 #I found this in the list of conditions without a description so I'm not sure what it does.
			}
		}
		add_country_modifier = {
			name = ravelian_absent_rectors
			duration = 3650
		}
		increase_unraveling_knowledge_medium = yes
	}
	#no
	option = {
		name = ravelian.301.b
		ai_chance = {
			factor = 30
		}
		add_country_modifier = {
			name = ravelian_focused_rectors
			duration = 3650
		}
	}
}

#Ravelian societies doing stuff that nations dislike. 

#Like maybe they meet up with members in a country you are at war with.
#Or they share some new invention outside your borders
#Or start collecting a tithe from the peasants

country_event = {
	id = ravelian.302
	title = ravelian.302.t
	desc = ravelian.302.d
	picture = BIG_BOOK_eventPicture
	
	trigger = {
		religion = ravelian
		#num_of_cardinals = 1
		NOT = { has_global_flag = fourth_ravelian_council }
		NOT = { has_global_flag = ravelian_council_active }
		has_dlc = "Emperor"
	}
	
	mean_time_to_happen = {
		months = 1000
	}
	
	immediate = {
		hidden_effect = {
			random_rival_country = {
				save_event_target_as = rival_country
			}
		}
	}
	
	#let them continue
	option = {
		name = "ravelian.302.a"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.5
				ruler_has_personality = secretive_personality
			}
			modifier = {
				factor = 0.5
				ruler_has_personality = intricate_web_weaver_personality
			}
			modifier = {
				factor = 1.5
				ruler_has_personality = kind_hearted_personality
			}
			modifier = {
				factor = 3
				ruler_has_personality = free_thinker_personality
			}
			modifier = {
				factor = 2
				ruler_has_personality = scholar_personality
			}
			modifier = {
				factor = 2
				ruler_has_personality = naive_personality
			}
			modifier = {
				factor = 0.1
				event_target:rival_country = {
					ai = no
				}
			}
		}
		tooltip = {
			event_target:rival_country = {
				add_country_modifier = {
					name = ravelian_rival_buff
					duration = 3650
				}
			}
		}
		event_target:rival_country = {
			country_event = {
				id = ravelian.303
			}
		}
		increase_unraveling_knowledge_medium = yes
	}
	#no
	option = {
		name = ravelian.302.b
		ai_chance = {
			factor = 50
		}
	}
}

country_event = {
	id = ravelian.303
	title = ravelian.303.t
	desc = ravelian.303.d
	picture = BIG_BOOK_eventPicture

	is_triggered_only = yes

	mean_time_to_happen = {
		months = 1
	}

	option = {
		name = "ravelian.303.a"
		add_country_modifier = {
			name = ravelian_rival_buff
			duration = 3650
		}
	}
}


#Ravelians Request Damestear Shipment (yes - large increase, temp goods produced malus) (no - medium decrease)

#Ravelians Request Precursor Relic Shipment (yes - large increase, temp goods produced malus) (no - medium decrease)

#Damestear Breakthrough! (cool - large increase, prestige)

#Precursor Relic Discovery! (cool - large increase, prestige)

#Stimulating Public Debate - as in people have a cool discussion in the streets (cool - medium increase, prestige)

#Revelation Humiliates Country - a ravelian discovery says you're lame (ok then - medium increase, prestige malus) (actually no - medium decrease)

#Local Research Grants (sure - medium increase, small money cost) (nah - prestige malus)

#Sponsored Thesis Flops - your ruler sponsored some research and its doing baad (i guess its bad then - prestige malus) (no its fine - more prestige malus, medium decrease)

#Young Genius (send them to the rectorate - large increase) (we can use them - gain good advisor, prob philosopher or natural scientist)

#[Root.Adjective] Revelations - your culture ravelians find something cool (awesome - medium increase, prestige)


#400s - special first council only - heaven, hell and salvation

#Ravelian Escort mission - they got some celestial shizz (provide escort - medium increase, mil loss) (nope - small prestige loss)

#Ravelians Ruin Cemetary - they researching nerat and fugue plane (fuck sake - medium increase, revolt risk) (chastize the ravelians - small increase)

#Foreign Expedition - they wanna research other cultures (fund them - large increase, dip cost) (no dude - small increase)

#Debate on Salvation (cool - medium increase)

#Debate on Hell (cool - small increase)

#Debate on Heaven (cool - large increase)

#Afterlife Debate Causes Panic (god dude - medium decrease, revolt risk increase)



#500s - special second council

#600s - special third council

#700s - special fourth council



#800s - ravelians in Aelantir

